<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>StdUseCase.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="$relpath/search.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<table width="100%">
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border="0" src="tilogo.gif" /></a></td>
  <td bgcolor="red"><img src="titagline.gif" /></td>
</tr>
</table>
<!-- Generated by Doxygen 1.8.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">StdUseCase.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_std_use_case_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (C) 2010 - 2014 Texas Instruments Incorporated - http://www.ti.com/ </span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> *  Redistribution and use in source and binary forms, with or without </span>
<a name="l00005"></a>00005 <span class="comment"> *  modification, are permitted provided that the following conditions </span>
<a name="l00006"></a>00006 <span class="comment"> *  are met:</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *    Redistributions of source code must retain the above copyright </span>
<a name="l00009"></a>00009 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *    Redistributions in binary form must reproduce the above copyright</span>
<a name="l00012"></a>00012 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the </span>
<a name="l00013"></a>00013 <span class="comment"> *    documentation and/or other materials provided with the   </span>
<a name="l00014"></a>00014 <span class="comment"> *    distribution.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *    Neither the name of Texas Instruments Incorporated nor the names of</span>
<a name="l00017"></a>00017 <span class="comment"> *    its contributors may be used to endorse or promote products derived</span>
<a name="l00018"></a>00018 <span class="comment"> *    from this software without specific prior written permission.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS </span>
<a name="l00021"></a>00021 <span class="comment"> *  &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT </span>
<a name="l00022"></a>00022 <span class="comment"> *  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00023"></a>00023 <span class="comment"> *  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT </span>
<a name="l00024"></a>00024 <span class="comment"> *  OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, </span>
<a name="l00025"></a>00025 <span class="comment"> *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT </span>
<a name="l00026"></a>00026 <span class="comment"> *  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00027"></a>00027 <span class="comment"> *  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00028"></a>00028 <span class="comment"> *  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT </span>
<a name="l00029"></a>00029 <span class="comment"> *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE </span>
<a name="l00030"></a>00030 <span class="comment"> *  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment">*/</span>
<a name="l00033"></a>00033 
<a name="l00040"></a>00040 <span class="comment">/*****************************************************************************/</span>
<a name="l00041"></a>00041 <span class="comment">/*                                 INCLUDES                                  */</span>
<a name="l00042"></a>00042 <span class="comment">/*****************************************************************************/</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="_std_use_case_8h.html">StdUseCase.h</a>&quot;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#ifndef WIN32</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#include &lt;thread&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#endif</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="keyword">using namespace </span>std;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">/*****************************************************************************/</span>
<a name="l00053"></a>00053 <span class="comment">/*                                 VARIABLES                                 */</span>
<a name="l00054"></a>00054 <span class="comment">/*****************************************************************************/</span>
<a name="l00055"></a>00055 
<a name="l00057"></a><a class="code" href="_std_use_case_8h.html#a260a28c69ae5c28651de2e0ea758d3e4">00057</a> <a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a> <a class="code" href="_std_use_case_8cpp.html#a260a28c69ae5c28651de2e0ea758d3e4" title="Struct for command line options.">g_sOpt</a> = { <span class="stringliteral">&quot;Unknown&quot;</span>, NULL, NULL, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0, NULL, NULL, NULL, NULL, NULL };
<a name="l00059"></a><a class="code" href="_std_use_case_8cpp.html#a128f85a45cbb355a9d5a674a4d96c5e4">00059</a> <a class="code" href="structs_r_t_e.html" title="Struct for runtime entries.">sRTE_t</a> <a class="code" href="_m_s_p430___flasher_8cpp.html#a128f85a45cbb355a9d5a674a4d96c5e4" title="Struct for runtime entries.">g_RTE</a>;
<a name="l00061"></a><a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899">00061</a> <a class="code" href="structs_usb_f_e_ts.html" title="Struct for storing information on all connected USB FETs.">sUsbFETs_t</a> <a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[<a class="code" href="_std_use_case_8h.html#a8b72a76a6bd89c6fc593bd979c74b3cc" title="Maximum number of connected USB FETs.">MAX_FET_NR</a>] = { {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0},
<a name="l00062"></a>00062                                    {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0}, {NULL, 0} };
<a name="l00063"></a>00063 
<a name="l00065"></a>00065 <span class="keyword">static</span> <span class="keyword">const</span> BYTE myLptVersion[] = <span class="stringliteral">&quot;L_01&quot;</span>;
<a name="l00067"></a><a class="code" href="_std_use_case_8cpp.html#a0ec8be96609f15e433d35a7725879041">00067</a> LONG  <a class="code" href="_std_use_case_8cpp.html#a0ec8be96609f15e433d35a7725879041" title="FET firmware version number.">FWVersion</a>;
<a name="l00069"></a><a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c">00069</a> BYTE* <a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a> = (BYTE*)myLptVersion;
<a name="l00070"></a>00070 <span class="keywordtype">char</span> FETversion[6] = {0};
<a name="l00071"></a>00071 
<a name="l00073"></a><a class="code" href="_std_use_case_8h.html#a9d17f42c18af28e98037e3037cc70977">00073</a> DEVICE_T <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>;
<a name="l00075"></a><a class="code" href="_std_use_case_8h.html#a0bdeb3e3473b3f68074570ba8c658a62">00075</a> LONG <a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[16];
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">// Status messages</span>
<a name="l00079"></a><a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270">00079</a> <span class="comment"></span>STATUS_T <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a>;
<a name="l00081"></a><a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9">00081</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a>;
<a name="l00083"></a><a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e">00083</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a>;
<a name="l00085"></a><a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b">00085</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a>;
<a name="l00087"></a><a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc">00087</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a>;
<a name="l00089"></a><a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707">00089</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a>;
<a name="l00091"></a><a class="code" href="_std_use_case_8cpp.html#a77065358bd3e03f6a1be294e552d7edf">00091</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a77065358bd3e03f6a1be294e552d7edf" title="Return value for MSP430_VerifyFile.">Ret_VerifyFile</a>;
<a name="l00093"></a><a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd">00093</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd" title="Return value for MSP430_Reset.">Ret_Reset</a>;
<a name="l00095"></a><a class="code" href="_std_use_case_8cpp.html#a3b1aff096d92e883f6dd2220da59dcd2">00095</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a3b1aff096d92e883f6dd2220da59dcd2" title="Return value for MSP430_Registers.">Ret_Registers</a>;
<a name="l00097"></a><a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18">00097</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a>;
<a name="l00099"></a><a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4">00099</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4" title="Return value for MSP430_FET_GetHwVersion.">Ret_GetHwVersion</a>;
<a name="l00101"></a><a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd">00101</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd" title="Return value for MSP430_FET_GetFwVersion.">Ret_GetFwVersion</a>;
<a name="l00103"></a><a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41">00103</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41" title="Return value for MSP430_MSP430_EEM_SetBreakpoint.">Ret_Breakpoints</a>;
<a name="l00105"></a><a class="code" href="_std_use_case_8cpp.html#a281df3aa4e2d2e077fb1268a5a7f0386">00105</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a281df3aa4e2d2e077fb1268a5a7f0386" title="Return value for MSP430_Run.">Ret_Run</a>;
<a name="l00107"></a><a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a">00107</a> STATUS_T <a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a" title="Return value for MSP430_Erase.">Ret_Erase</a>;
<a name="l00108"></a>00108 
<a name="l00110"></a><a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab">00110</a> LONG <a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>;
<a name="l00112"></a><a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1">00112</a> LONG <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>;
<a name="l00113"></a>00113 
<a name="l00115"></a><a class="code" href="_std_use_case_8cpp.html#a699f2f70c2c4eb89b277c536dc217b76">00115</a> LONG <a class="code" href="_std_use_case_8cpp.html#a699f2f70c2c4eb89b277c536dc217b76" title="Handle for FW update callback function.">myHandle</a>;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="keyword">extern</span> <a class="code" href="structs_def.html" title="Struct for default options.">sDef_t</a> <a class="code" href="_m_s_p430___flasher_8cpp.html#abaebf859b60de1e16ec5c94063985ea5" title="Default options.">g_Def</a>;
<a name="l00118"></a>00118 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a>;
<a name="l00119"></a>00119 <span class="keyword">extern</span> FILE* <a class="code" href="_std_use_case_8cpp.html#aa57653e6a16d747a67dddb6ff569d9a1" title="File pointer for logfile.">lfile</a>;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 UINT wParam_prev = 0;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">// Breakpoint help variables</span>
<a name="l00124"></a>00124 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="_std_use_case_8cpp.html#ac5178787362679f401728513abc2b1ab" title="Number of breakpoints.">BPcount</a>;
<a name="l00125"></a>00125 <span class="keyword">extern</span> LONG <a class="code" href="_m_s_p430___flasher_8cpp.html#ac47340431e6fbc351baa9be2fb8bd7b4" title="Array for storing breakpoint addresses.">BPAddr</a>[];
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">// the following declarations are merged from getopt.cpp</span>
<a name="l00129"></a><a class="code" href="_std_use_case_8h.html#ad5e1c16213bbee2d5e8cc363309f418c">00129</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="_std_use_case_8cpp.html#ad5e1c16213bbee2d5e8cc363309f418c" title="Index for command line options.">optind</a> = 1;
<a name="l00131"></a><a class="code" href="_std_use_case_8h.html#adb50a0eab9fed92fc3bfc7dfa4f2c410">00131</a> <span class="keywordtype">char</span> *<a class="code" href="_std_use_case_8cpp.html#adb50a0eab9fed92fc3bfc7dfa4f2c410" title="Pointer to an option argument.">optarg</a>;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="preprocessor">#ifndef INFINITE</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">unsigned</span> INFINITE = 0xFFFFFFFF;
<a name="l00135"></a>00135 <span class="preprocessor">#endif</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>
<a name="l00137"></a>00137 <span class="preprocessor">#ifndef WIN32</span>
<a name="l00138"></a>00138 <span class="preprocessor"></span><span class="keywordtype">void</span> Sleep(<span class="keywordtype">unsigned</span> ms)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140     this_thread::sleep_for(chrono::milliseconds(ms));
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 <span class="preprocessor">#endif</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>
<a name="l00144"></a><a class="code" href="class_event.html">00144</a> <span class="keyword">class </span><a class="code" href="class_event.html">Event</a>
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146 <span class="keyword">public</span>:
<a name="l00147"></a>00147     <a class="code" href="class_event.html">Event</a>();
<a name="l00148"></a>00148     <span class="keywordtype">bool</span> wait(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timeout);
<a name="l00149"></a>00149     <span class="keywordtype">void</span> <span class="keyword">set</span>();
<a name="l00150"></a>00150     <span class="keywordtype">void</span> reset();
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="keyword">private</span>:
<a name="l00153"></a>00153 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>    HANDLE event_;
<a name="l00155"></a>00155 <span class="preprocessor">#else</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>    <span class="keywordtype">bool</span> hasOccured_;
<a name="l00157"></a>00157     mutex mutex_;
<a name="l00158"></a>00158     condition_variable condition_;
<a name="l00159"></a>00159 <span class="preprocessor">#endif</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span>};
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>Event::Event() : event_(CreateEvent(NULL, FALSE, FALSE, NULL)) {}
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="keywordtype">void</span> Event::set()
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167     SetEvent(event_);
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 <span class="keywordtype">void</span> Event::reset()
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172     ResetEvent(event_);
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="keywordtype">bool</span> Event::wait(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> msTimeout)
<a name="l00176"></a>00176 {
<a name="l00177"></a>00177     <span class="keywordflow">return</span> (WaitForSingleObject(event_, msTimeout) == WAIT_OBJECT_0);
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 <span class="preprocessor">#else</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>Event::Event() : hasOccured_(false) {}
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="keywordtype">void</span> Event::set()
<a name="l00183"></a>00183 {
<a name="l00184"></a>00184     unique_lock&lt;mutex&gt; lock(mutex_);
<a name="l00185"></a>00185     hasOccured_ = <span class="keyword">true</span>; 
<a name="l00186"></a>00186     condition_.notify_all();
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="keywordtype">void</span> Event::reset()
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191     unique_lock&lt;mutex&gt; lock(mutex_);
<a name="l00192"></a>00192     hasOccured_ = <span class="keyword">false</span>;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="keywordtype">bool</span> Event::wait(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> msTimeout)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197     unique_lock&lt;mutex&gt; lock(mutex_);
<a name="l00198"></a>00198     <span class="keywordflow">return</span> condition_.wait_for(lock, chrono::milliseconds(msTimeout), [<span class="keyword">this</span>](){<span class="keywordflow">return</span> hasOccured_;});
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 <span class="preprocessor">#endif</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span>
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="comment">/*****************************************************************************/</span>
<a name="l00204"></a>00204 <span class="comment">/*                                FUNCTIONS                                  */</span>
<a name="l00205"></a>00205 <span class="comment">/*****************************************************************************/</span>
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="comment">/*****************************************************************************/</span>
<a name="l00210"></a><a class="code" href="_std_use_case_8h.html#acf8efd527ab1d58c719a331b813a984b">00210</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#acf8efd527ab1d58c719a331b813a984b" title="This function initializes the debug interface.">StdUseCase_InterfaceInit</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <span class="comment">// set all status messages to STATUS_ERROR (convention)</span>
<a name="l00213"></a>00213     <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a>   = STATUS_ERROR;
<a name="l00214"></a>00214     <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a>          = STATUS_ERROR;
<a name="l00215"></a>00215     <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a>    = STATUS_ERROR;
<a name="l00216"></a>00216     <a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a>   = STATUS_ERROR;
<a name="l00217"></a>00217     <a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a>     = STATUS_ERROR;
<a name="l00218"></a>00218     <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a>  = STATUS_ERROR;
<a name="l00219"></a>00219     <a class="code" href="_std_use_case_8cpp.html#a77065358bd3e03f6a1be294e552d7edf" title="Return value for MSP430_VerifyFile.">Ret_VerifyFile</a>   = STATUS_ERROR;
<a name="l00220"></a>00220     <a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd" title="Return value for MSP430_Reset.">Ret_Reset</a>        = STATUS_ERROR;
<a name="l00221"></a>00221     <a class="code" href="_std_use_case_8cpp.html#a3b1aff096d92e883f6dd2220da59dcd2" title="Return value for MSP430_Registers.">Ret_Registers</a>    = STATUS_ERROR;
<a name="l00222"></a>00222     <a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a>     = STATUS_ERROR;
<a name="l00223"></a>00223     <a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4" title="Return value for MSP430_FET_GetHwVersion.">Ret_GetHwVersion</a> = STATUS_ERROR;
<a name="l00224"></a>00224     <a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd" title="Return value for MSP430_FET_GetFwVersion.">Ret_GetFwVersion</a> = STATUS_ERROR;
<a name="l00225"></a>00225     <a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41" title="Return value for MSP430_MSP430_EEM_SetBreakpoint.">Ret_Breakpoints</a>  = STATUS_ERROR;
<a name="l00226"></a>00226     <a class="code" href="_std_use_case_8cpp.html#a281df3aa4e2d2e077fb1268a5a7f0386" title="Return value for MSP430_Run.">Ret_Run</a>          = STATUS_ERROR;
<a name="l00227"></a>00227     <a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a" title="Return value for MSP430_Erase.">Ret_Erase</a>        = STATUS_ERROR;
<a name="l00228"></a>00228     <a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>       = 0;
<a name="l00229"></a>00229     <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>   = NO_ERR;
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     <span class="keywordtype">string</span> Interface(sOpt-&gt;pcInterface ? sOpt-&gt;pcInterface : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00232"></a>00232     <span class="keywordtype">int</span> NumberOfUsbIfs = 0, nr;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Checking for available FET debuggers: &quot;</span>);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     NumberOfUsbIfs = <a class="code" href="_std_use_case_8cpp.html#ab06ad4cf27f2d38614fee9e9c670d6f4" title="This function scans for all connected USB FETs and stores the respective COM port and the status of t...">StdUseCase_GetUsbIfs</a>();
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="keywordflow">if</span>(Interface.find(<span class="stringliteral">&quot;LPT&quot;</span>) != 0)
<a name="l00239"></a>00239     {
<a name="l00240"></a>00240         <span class="keywordtype">int</span> i = 0;
<a name="l00241"></a>00241         <span class="keywordtype">bool</span> FoundUsbFET = <span class="keyword">false</span>;
<a name="l00242"></a>00242  
<a name="l00243"></a>00243         
<a name="l00244"></a>00244         <span class="comment">// if a &quot;broken&quot; USB FET is connected, no other USB FETs can be detected</span>
<a name="l00245"></a>00245         <span class="keywordflow">if</span>(<span class="keywordtype">string</span>(<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[0].COMport) == <span class="stringliteral">&quot;HID_FET&quot;</span>)
<a name="l00246"></a>00246         {
<a name="l00247"></a>00247             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Corrupted USB FET firmware detected. Starting recovery.&quot;</span>);
<a name="l00248"></a>00248 
<a name="l00249"></a>00249             <span class="keywordflow">if</span>((MSP430_Initialize(<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[0].COMport, &amp;<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>) == STATUS_OK) &amp;&amp; (<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a> == <a class="code" href="_std_use_case_8h.html#a4df9bb382cb052f2ef159018a82f6f46" title="Broken eZ-FET detected - FET recovery required.">BROKEN_EZ_FET</a>))
<a name="l00250"></a>00250             {    
<a name="l00251"></a>00251                 <span class="comment">// perform USB FET recovery</span>
<a name="l00252"></a>00252                 <span class="keywordflow">if</span>(MSP430_FET_FwUpdate(NULL, &amp;<a class="code" href="_std_use_case_8cpp.html#a9b07175fdfea91c212f7dc65107ef6bd" title="This function is of type MSP430_FET_NOTIFY_FUNC and generates system messages to inform the user of t...">MY_MSP430_CallbackFunc</a>, <a class="code" href="_std_use_case_8cpp.html#a699f2f70c2c4eb89b277c536dc217b76" title="Handle for FW update callback function.">myHandle</a>) != STATUS_OK)
<a name="l00253"></a>00253                 {
<a name="l00254"></a>00254                     <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00255"></a>00255                     <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_FET_FWUPDATE, 0);
<a name="l00256"></a>00256                 }
<a name="l00257"></a>00257                 <span class="keywordflow">else</span>
<a name="l00258"></a>00258                 {
<a name="l00259"></a>00259                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* USB FET recovery completed.&quot;</span>);
<a name="l00260"></a>00260                 }
<a name="l00261"></a>00261                 <span class="comment">// scan for all connected USB FETs again</span>
<a name="l00262"></a>00262                 NumberOfUsbIfs = <a class="code" href="_std_use_case_8cpp.html#ab06ad4cf27f2d38614fee9e9c670d6f4" title="This function scans for all connected USB FETs and stores the respective COM port and the status of t...">StdUseCase_GetUsbIfs</a>();
<a name="l00263"></a>00263             }
<a name="l00264"></a>00264             <span class="keywordflow">else</span>
<a name="l00265"></a>00265             {
<a name="l00266"></a>00266                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00267"></a>00267                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_INITIALIZE, 0);
<a name="l00268"></a>00268             }
<a name="l00269"></a>00269         }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271         <span class="keywordflow">for</span>(i=0;i&lt;NumberOfUsbIfs;i++)
<a name="l00272"></a>00272         {
<a name="l00273"></a>00273             <span class="keywordflow">if</span>((Interface == <span class="stringliteral">&quot;USB&quot;</span>)                       ||    <span class="comment">// if no COM port specified</span>
<a name="l00274"></a>00274                (Interface == <span class="stringliteral">&quot;TIUSB&quot;</span>)                     ||    <span class="comment">// ...</span>
<a name="l00275"></a>00275                (Interface == <span class="keywordtype">string</span>(<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[i].COMport)))       <span class="comment">// OR if USB FET was found on selected COM port</span>
<a name="l00276"></a>00276             {
<a name="l00277"></a>00277                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Found USB FET @ %s.&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[i].COMport);
<a name="l00278"></a>00278                 <span class="keywordflow">if</span> (<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[i].status != 1 &amp;&amp; FoundUsbFET == <span class="keyword">false</span>)
<a name="l00279"></a>00279                 {
<a name="l00280"></a>00280                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; &lt;- Selected\n&quot;</span>);
<a name="l00281"></a>00281                     FoundUsbFET = <span class="keyword">true</span>;
<a name="l00282"></a>00282                     nr = i;
<a name="l00283"></a>00283                 }
<a name="l00284"></a>00284                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[i].status == 1)
<a name="l00285"></a>00285                 {
<a name="l00286"></a>00286                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; &lt;- Already in use\n&quot;</span>);
<a name="l00287"></a>00287                 }
<a name="l00288"></a>00288                 <span class="keywordflow">else</span>
<a name="l00289"></a>00289                 {
<a name="l00290"></a>00290                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00291"></a>00291                 }
<a name="l00292"></a>00292             }
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294 
<a name="l00295"></a>00295         <span class="keywordflow">if</span>(FoundUsbFET == <span class="keyword">false</span>)
<a name="l00296"></a>00296         {
<a name="l00297"></a>00297             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Couldn&#39;t find available FET @ %s. Aborting.\n&quot;</span>, sOpt-&gt;pcInterface);
<a name="l00298"></a>00298             <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00299"></a>00299             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, 0);
<a name="l00300"></a>00300         }
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Initializing interface @ %s...&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[nr].COMport);
<a name="l00304"></a>00304     
<a name="l00305"></a>00305     <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> = MSP430_Initialize(sOpt-&gt;pcInterface, &amp;<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>);
<a name="l00306"></a>00306     <span class="keywordflow">if</span> (<a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> == STATUS_ERROR)
<a name="l00307"></a>00307     {
<a name="l00308"></a>00308         <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00309"></a>00309         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_INITIALIZE, 0);
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 <span class="comment">/*****************************************************************************/</span>
<a name="l00317"></a><a class="code" href="_std_use_case_8h.html#ab06ad4cf27f2d38614fee9e9c670d6f4">00317</a> <span class="keywordtype">int</span> <a class="code" href="_std_use_case_8cpp.html#ab06ad4cf27f2d38614fee9e9c670d6f4" title="This function scans for all connected USB FETs and stores the respective COM port and the status of t...">StdUseCase_GetUsbIfs</a>(<span class="keywordtype">void</span>)
<a name="l00318"></a>00318 {
<a name="l00319"></a>00319     <span class="keywordtype">int</span> i = 0;
<a name="l00320"></a>00320     LONG NumberOfUsbIfs = 0;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322     <span class="keywordflow">if</span>(MSP430_GetNumberOfUsbIfs(&amp;NumberOfUsbIfs) != STATUS_OK)
<a name="l00323"></a>00323     {
<a name="l00324"></a>00324         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_GETNUMBEROFUSBIFS, 0);
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     <span class="keywordflow">if</span>(NumberOfUsbIfs == 0)
<a name="l00328"></a>00328     {
<a name="l00329"></a>00329         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Couldn&#39;t find any connected USB FETs!\n&quot;</span>);
<a name="l00330"></a>00330         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, 0);
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333     <span class="keywordflow">for</span>(i=0;i&lt;NumberOfUsbIfs;i++)
<a name="l00334"></a>00334     {
<a name="l00335"></a>00335         <span class="keywordflow">if</span>(MSP430_GetNameOfUsbIf(i, &amp;<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[i].COMport, &amp;<a class="code" href="_std_use_case_8cpp.html#ada85341d32cf9f4912186503ee9d2899" title="Array for storing information on all connected USB FETs.">UsbFETs</a>[i].status) != STATUS_OK)
<a name="l00336"></a>00336         {
<a name="l00337"></a>00337             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Error reading FET information!\n&quot;</span>);
<a name="l00338"></a>00338             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_GETNAMEOFUSBIF, 0);
<a name="l00339"></a>00339         }
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341     <span class="keywordflow">return</span> NumberOfUsbIfs;
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">/*****************************************************************************/</span>
<a name="l00351"></a><a class="code" href="_std_use_case_8h.html#aea27f62bd8701ea4f72651acb0405154">00351</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#aea27f62bd8701ea4f72651acb0405154" title="This function checks whether the MSP430.dll version number and the version of the debugger firmware m...">StdUseCase_CheckFirmware</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Checking firmware compatibility: &quot;</span>);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     <span class="keywordflow">if</span> (<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a> == <a class="code" href="_std_use_case_8h.html#ad9f4c7b725670596e2986ea5e927a030" title="Mismatch between DLL version and FET firmware - FET firmware update required.">DLL_FW_MISMATCH</a> || <a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a> == <a class="code" href="_std_use_case_8h.html#a3b7033857e8928a9e796133413d7b0f1" title="FET uses DLLv2 firmware - Major upgrade required.">V2_TO_V3_UPGRADE_REQUIRED</a>)    <span class="comment">// if conflict between firmware versions</span>
<a name="l00356"></a>00356     {
<a name="l00357"></a>00357         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* The firmware of your FET is outdated.\n&quot;</span>);    <span class="comment">// prompt user about an update</span>
<a name="l00358"></a>00358 
<a name="l00359"></a>00359         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#aae8dc638e0436e2d8d07bca09401ac38" title="This flag is set if FET FW update should be performed without a user prompt.">SKIP_UDPROMPT</a>)
<a name="l00360"></a>00360         {
<a name="l00361"></a>00361             <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> = STATUS_ERROR; <span class="comment">// convention, set to error first</span>
<a name="l00362"></a>00362 
<a name="l00363"></a>00363             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Skipped firmware update prompt.\n&quot;</span>);
<a name="l00364"></a>00364             <span class="keywordflow">if</span>(MSP430_FET_FwUpdate(NULL, &amp;<a class="code" href="_std_use_case_8cpp.html#a9b07175fdfea91c212f7dc65107ef6bd" title="This function is of type MSP430_FET_NOTIFY_FUNC and generates system messages to inform the user of t...">MY_MSP430_CallbackFunc</a>, <a class="code" href="_std_use_case_8cpp.html#a699f2f70c2c4eb89b277c536dc217b76" title="Handle for FW update callback function.">myHandle</a>) != STATUS_OK) <span class="comment">// if update fails</span>
<a name="l00365"></a>00365             {
<a name="l00366"></a>00366                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00367"></a>00367                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_FET_FWUPDATE, 0);
<a name="l00368"></a>00368             }
<a name="l00369"></a>00369             <span class="keywordflow">if</span>( (<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a> == <a class="code" href="_std_use_case_8h.html#a3b7033857e8928a9e796133413d7b0f1" title="FET uses DLLv2 firmware - Major upgrade required.">V2_TO_V3_UPGRADE_REQUIRED</a>) &amp;&amp; (<a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a> == STATUS_OK) ) <span class="comment">// UIF is now enumerated as CDC device, so reinitialize</span>
<a name="l00370"></a>00370             {
<a name="l00371"></a>00371                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* FET has been updated to DLLv3. Reinitializing...\n&quot;</span>);
<a name="l00372"></a>00372                 Sleep(10000);
<a name="l00373"></a>00373             }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375             <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> = MSP430_Initialize(sOpt-&gt;pcInterface, &amp;<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>);
<a name="l00376"></a>00376             <span class="keywordflow">if</span> (<a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> != STATUS_OK)
<a name="l00377"></a>00377             {
<a name="l00378"></a>00378                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00379"></a>00379                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_INITIALIZE, 0);
<a name="l00380"></a>00380             }
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382         <span class="keywordflow">else</span>
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384             <span class="keywordtype">bool</span> updProcRunning = <span class="keyword">true</span>;
<a name="l00385"></a>00385             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;- Would you like to update it? (Y/N): &quot;</span>);
<a name="l00386"></a>00386 
<a name="l00387"></a>00387             <span class="keywordflow">while</span> (updProcRunning)
<a name="l00388"></a>00388             {
<a name="l00389"></a>00389                 <span class="keywordtype">char</span> FW_Update_entry;                        <span class="comment">// for storing runtime single key entries</span>
<a name="l00390"></a>00390                 cin  &gt;&gt; FW_Update_entry;
<a name="l00391"></a>00391                 cin.ignore();
<a name="l00392"></a>00392                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad86ef0ad08a24ecae8a2e95b350a7ca7" title="Log message.">LOG_MSG</a>, <span class="stringliteral">&quot;%c\n&quot;</span>, FW_Update_entry);
<a name="l00393"></a>00393                         
<a name="l00394"></a>00394                 <span class="keywordflow">if</span>(strchr(<span class="stringliteral">&quot;Yy&quot;</span>, FW_Update_entry) != NULL)
<a name="l00395"></a>00395                 {
<a name="l00396"></a>00396                     <span class="keywordflow">while</span>((<a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a> = MSP430_FET_FwUpdate(NULL, &amp;<a class="code" href="_std_use_case_8cpp.html#a9b07175fdfea91c212f7dc65107ef6bd" title="This function is of type MSP430_FET_NOTIFY_FUNC and generates system messages to inform the user of t...">MY_MSP430_CallbackFunc</a>, <a class="code" href="_std_use_case_8cpp.html#a699f2f70c2c4eb89b277c536dc217b76" title="Handle for FW update callback function.">myHandle</a>)) != STATUS_OK) <span class="comment">// if update fails</span>
<a name="l00397"></a>00397                     {
<a name="l00398"></a>00398                         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Update failed. (R)etry/(C)ancel? &quot;</span>);  <span class="comment">// prompt user</span>
<a name="l00399"></a>00399                                 
<a name="l00400"></a>00400                         <span class="keywordflow">while</span>(1)
<a name="l00401"></a>00401                         {
<a name="l00402"></a>00402                             cin  &gt;&gt; FW_Update_entry;
<a name="l00403"></a>00403                             cin.ignore();
<a name="l00404"></a>00404                             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad86ef0ad08a24ecae8a2e95b350a7ca7" title="Log message.">LOG_MSG</a>, <span class="stringliteral">&quot;%c\n&quot;</span>, FW_Update_entry);
<a name="l00405"></a>00405                             <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;CcRr&quot;</span>, FW_Update_entry) != NULL) <span class="keywordflow">break</span>;
<a name="l00406"></a>00406                         }
<a name="l00407"></a>00407                                 
<a name="l00408"></a>00408                         <span class="keywordflow">if</span>        (strchr(<span class="stringliteral">&quot;Cc&quot;</span>, FW_Update_entry) != NULL) <span class="keywordflow">break</span>;
<a name="l00409"></a>00409                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;Rr&quot;</span>, FW_Update_entry) != NULL) <span class="keywordflow">continue</span>;
<a name="l00410"></a>00410                     }
<a name="l00411"></a>00411                     <span class="keywordflow">if</span>((<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a> == <a class="code" href="_std_use_case_8h.html#a3b7033857e8928a9e796133413d7b0f1" title="FET uses DLLv2 firmware - Major upgrade required.">V2_TO_V3_UPGRADE_REQUIRED</a>) &amp;&amp; (<a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a> == STATUS_OK)) <span class="comment">// UIF is now enumerated as CDC device, so reinitialize</span>
<a name="l00412"></a>00412                     {
<a name="l00413"></a>00413                         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* FET has been updated to DLLv3. Reinitializing...\n&quot;</span>);
<a name="l00414"></a>00414                         <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> = STATUS_ERROR; <span class="comment">// convention, set to error first</span>
<a name="l00415"></a>00415                         Sleep(10000);
<a name="l00416"></a>00416                         <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> = MSP430_Initialize(sOpt-&gt;pcInterface, &amp;<a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>);
<a name="l00417"></a>00417                     }
<a name="l00418"></a>00418                 }
<a name="l00419"></a>00419                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strchr(<span class="stringliteral">&quot;Nn&quot;</span>, FW_Update_entry) != NULL) <span class="keywordflow">break</span>;
<a name="l00420"></a>00420                 <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;
<a name="l00421"></a>00421                 
<a name="l00422"></a>00422                 <span class="comment">// in case of update failure or unsuccessful initialization, quit flasher</span>
<a name="l00423"></a>00423                 <span class="keywordflow">if</span> ((<a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a> == STATUS_ERROR) || (<a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> == STATUS_ERROR))
<a name="l00424"></a>00424                 {
<a name="l00425"></a>00425                     <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l00426"></a>00426                     <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_FET_FWUPDATE, 0);
<a name="l00427"></a>00427                 }
<a name="l00428"></a>00428                 <span class="comment">// otherwise continue</span>
<a name="l00429"></a>00429                 <span class="keywordflow">else</span>
<a name="l00430"></a>00430                 {
<a name="l00431"></a>00431                     updProcRunning = <span class="keyword">false</span>;
<a name="l00432"></a>00432                 }
<a name="l00433"></a>00433             }
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436     <span class="keywordflow">else</span>
<a name="l00437"></a>00437     {
<a name="l00438"></a>00438         <a class="code" href="_std_use_case_8cpp.html#aeedfaaec42b54d12f00a1427cf07bb18" title="Return value for MSP430_FET_FwUpdate.">Ret_FWUpdate</a> = STATUS_OK;
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* FET firmware is up to date.\n&quot;</span>);
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <span class="comment">/*****************************************************************************/</span>
<a name="l00446"></a><a class="code" href="_std_use_case_8h.html#af9544f15f69155e4e57015d03da9dd30">00446</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#af9544f15f69155e4e57015d03da9dd30" title="This function reads out the debugger firmware version.">StdUseCase_ReadFWVersion</a>(<span class="keywordtype">void</span>)
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Reading FW version...&quot;</span>);
<a name="l00449"></a>00449             
<a name="l00450"></a>00450     <a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd" title="Return value for MSP430_FET_GetFwVersion.">Ret_GetFwVersion</a> = MSP430_FET_GetFwVersion(&amp;<a class="code" href="_std_use_case_8cpp.html#a0ec8be96609f15e433d35a7725879041" title="FET firmware version number.">FWVersion</a>);
<a name="l00451"></a>00451     <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> = MSP430_Error_Number();
<a name="l00452"></a>00452     <span class="comment">// if FET does not support Fw call</span>
<a name="l00453"></a>00453     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> == INTERFACE_SUPPORT_ERR)
<a name="l00454"></a>00454     {
<a name="l00455"></a>00455         <a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd" title="Return value for MSP430_FET_GetFwVersion.">Ret_GetFwVersion</a> = STATUS_OK;
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457 }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment">/*****************************************************************************/</span>
<a name="l00461"></a><a class="code" href="_std_use_case_8h.html#a2a68108478db7b89241ca1eb5d0014f4">00461</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a2a68108478db7b89241ca1eb5d0014f4" title="This function reads out the debugger hardware version.">StdUseCase_ReadHWVersion</a>(<span class="keywordtype">void</span>)
<a name="l00462"></a>00462 {
<a name="l00463"></a>00463     LONG  HWVersionCount;
<a name="l00464"></a>00464     <span class="keywordtype">char</span> temp[3] = {0};
<a name="l00465"></a>00465     
<a name="l00466"></a>00466     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Reading HW version...&quot;</span>);
<a name="l00467"></a>00467             
<a name="l00468"></a>00468     <a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4" title="Return value for MSP430_FET_GetHwVersion.">Ret_GetHwVersion</a> = MSP430_FET_GetHwVersion(&amp;<a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a>,&amp;HWVersionCount);
<a name="l00469"></a>00469     <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> = MSP430_Error_Number();
<a name="l00470"></a>00470     <span class="comment">// if FET does not support Hw call</span>
<a name="l00471"></a>00471     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> == INTERFACE_SUPPORT_ERR)
<a name="l00472"></a>00472     {
<a name="l00473"></a>00473         <a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4" title="Return value for MSP430_FET_GetHwVersion.">Ret_GetHwVersion</a> = STATUS_OK;
<a name="l00474"></a>00474         <a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a> = (BYTE*)myLptVersion;
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     FETversion[0] = <a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a>[0];
<a name="l00478"></a>00478     sprintf(temp, <span class="stringliteral">&quot;%d&quot;</span>, (<span class="keywordtype">int</span>)<a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a>[3]);
<a name="l00479"></a>00479     FETversion[1] = temp[0];
<a name="l00480"></a>00480     FETversion[2] = 0x2E; <span class="comment">// &quot;.&quot;</span>
<a name="l00481"></a>00481     sprintf(temp, <span class="stringliteral">&quot;%d&quot;</span>, (<span class="keywordtype">int</span>)HWVersion[2]);
<a name="l00482"></a>00482     FETversion[3] = temp[0];
<a name="l00483"></a>00483     FETversion[4] = temp[1];
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="comment">/*****************************************************************************/</span>
<a name="l00488"></a><a class="code" href="_std_use_case_8h.html#a00e89ae44a8b655b0d608064523a9e3d">00488</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a00e89ae44a8b655b0d608064523a9e3d" title="This function sets the target voltage.">StdUseCase_PowerUp</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00489"></a>00489 {    
<a name="l00490"></a>00490     <span class="keywordflow">if</span>(sOpt-&gt;pcVCC &gt; 3600 || sOpt-&gt;pcVCC &lt; 1800)
<a name="l00491"></a>00491     {
<a name="l00492"></a>00492         <span class="keywordflow">if</span>(sOpt-&gt;pcVCC != 0)
<a name="l00493"></a>00493         {
<a name="l00494"></a>00494             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Invalid voltage specified in exit specs. Using default (%d mV)...&quot;</span>, <a class="code" href="_std_use_case_8h.html#ae39e5cfadf0e3a4ad00a6b9daf103ad9" title="Default target voltage.">TARGET_VCC</a>);
<a name="l00495"></a>00495         }
<a name="l00496"></a>00496         <span class="keywordflow">else</span>
<a name="l00497"></a>00497         {
<a name="l00498"></a>00498             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Setting VCC to %d mV...&quot;</span>, <a class="code" href="_std_use_case_8h.html#ae39e5cfadf0e3a4ad00a6b9daf103ad9" title="Default target voltage.">TARGET_VCC</a>);
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a> = MSP430_VCC(<a class="code" href="_std_use_case_8h.html#ae39e5cfadf0e3a4ad00a6b9daf103ad9" title="Default target voltage.">TARGET_VCC</a>);
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503     <span class="keywordflow">else</span>
<a name="l00504"></a>00504     {
<a name="l00505"></a>00505         <span class="keywordtype">int</span> VCC = 0;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         <span class="keywordflow">if</span>(strcmp(FETversion, <span class="stringliteral">&quot;E2.0&quot;</span>) == 0 || strcmp(FETversion, <span class="stringliteral">&quot;E3.0&quot;</span>) == 0 || strcmp(FETversion, <span class="stringliteral">&quot;E4.0&quot;</span>) == 0)
<a name="l00508"></a>00508         {
<a name="l00509"></a>00509             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Debugger does not support target voltages other than %d mV!\n&quot;</span>, <a class="code" href="_std_use_case_8h.html#ae39e5cfadf0e3a4ad00a6b9daf103ad9" title="Default target voltage.">TARGET_VCC</a>);
<a name="l00510"></a>00510             VCC = <a class="code" href="_std_use_case_8h.html#ae39e5cfadf0e3a4ad00a6b9daf103ad9" title="Default target voltage.">TARGET_VCC</a>;
<a name="l00511"></a>00511         }
<a name="l00512"></a>00512         <span class="keywordflow">else</span>
<a name="l00513"></a>00513         {
<a name="l00514"></a>00514             VCC = sOpt-&gt;pcVCC;
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Setting VCC to %d mV...&quot;</span>, VCC);            
<a name="l00518"></a>00518         <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a> = MSP430_VCC(VCC);
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> = MSP430_Error_Number();
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a> != STATUS_OK)
<a name="l00524"></a>00524     {
<a name="l00525"></a>00525         <span class="comment">// check if target is powered by external voltage source</span>
<a name="l00526"></a>00526         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> == EX_POWER_OK)
<a name="l00527"></a>00527         {
<a name="l00528"></a>00528             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Target is powered externally.&quot;</span>);
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530         <span class="keywordflow">else</span>
<a name="l00531"></a>00531         {
<a name="l00532"></a>00532             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VCC, <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>);
<a name="l00533"></a>00533         }
<a name="l00534"></a>00534     }
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">/*****************************************************************************/</span>
<a name="l00540"></a><a class="code" href="_std_use_case_8h.html#a380a381c74a6d26e6a033a280de4a5ea">00540</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a380a381c74a6d26e6a033a280de4a5ea" title="Configure the device according to the chosen connection type.">StdUseCase_Configure</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542     LONG value;
<a name="l00543"></a>00543     <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a> = STATUS_OK;
<a name="l00544"></a>00544     <span class="keywordtype">string</span> Mode(sOpt-&gt;pcMode ? sOpt-&gt;pcMode : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00545"></a>00545 
<a name="l00546"></a>00546     <span class="comment">// save value of status according to parameter</span>
<a name="l00547"></a>00547     <span class="keywordflow">if</span> (Mode == <span class="stringliteral">&quot;JTAG&quot;</span>)
<a name="l00548"></a>00548     {
<a name="l00549"></a>00549         value = JTAG_IF;
<a name="l00550"></a>00550     }
<a name="l00551"></a>00551     <span class="keywordflow">else</span> 
<a name="l00552"></a>00552     <span class="keywordflow">if</span> (Mode == <span class="stringliteral">&quot;SBW2&quot;</span>)
<a name="l00553"></a>00553     {
<a name="l00554"></a>00554         value = SPYBIWIRE_IF;
<a name="l00555"></a>00555     }
<a name="l00556"></a>00556     <span class="keywordflow">else</span>
<a name="l00557"></a>00557     <span class="keywordflow">if</span> (Mode == <span class="stringliteral">&quot;SBW4&quot;</span>)
<a name="l00558"></a>00558     {
<a name="l00559"></a>00559         value = SPYBIWIREJTAG_IF;
<a name="l00560"></a>00560     }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="comment">// Execute &quot;total erase&quot; to remove active memory protection before </span>
<a name="l00563"></a>00563     <span class="comment">// attempting to open device (for FR5xx/FR6xx devices - except FR57xx)</span>
<a name="l00564"></a>00564     <span class="keywordflow">if</span>(strcmp(sOpt-&gt;pcEraseType, <span class="stringliteral">&quot;ERASE_TOTAL&quot;</span>) == 0)
<a name="l00565"></a>00565     {
<a name="l00566"></a>00566         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Performing total erase...&quot;</span>);
<a name="l00567"></a>00567         <a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a" title="Return value for MSP430_Erase.">Ret_Erase</a> = MSP430_Erase(ERASE_TOTAL, 0x0, 0x0);
<a name="l00568"></a>00568         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a" title="Return value for MSP430_Erase.">Ret_Erase</a> != STATUS_OK)
<a name="l00569"></a>00569         {
<a name="l00570"></a>00570             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_ERASE, 0);
<a name="l00571"></a>00571         }
<a name="l00572"></a>00572     }
<a name="l00573"></a>00573     <span class="comment">// Execute &quot;user code erase&quot; (for FR4xx devices)</span>
<a name="l00574"></a>00574     <span class="keywordflow">if</span>(strcmp(sOpt-&gt;pcEraseType, <span class="stringliteral">&quot;ERASE_USER_CODE&quot;</span>) == 0)
<a name="l00575"></a>00575     {
<a name="l00576"></a>00576         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Performing user code erase...&quot;</span>);
<a name="l00577"></a>00577         <a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a" title="Return value for MSP430_Erase.">Ret_Erase</a> = MSP430_Erase(ERASE_USER_CODE, 0x0, 0x0);
<a name="l00578"></a>00578         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a4e1551abbf8e7ca2696b7835931a7a6a" title="Return value for MSP430_Erase.">Ret_Erase</a> != STATUS_OK)
<a name="l00579"></a>00579         {
<a name="l00580"></a>00580             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_ERASE, 0);
<a name="l00581"></a>00581         }
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="comment">// Automatic interface detection is the default setting. MSP430_Configure(INTERFACE_MODE, ...) </span>
<a name="l00585"></a>00585     <span class="comment">// must not be called with AUTOMATIC_IF as DLLv2 based tools don&#39;t support this.</span>
<a name="l00586"></a>00586     <span class="keywordflow">if</span>(Mode != <span class="stringliteral">&quot;AUTO&quot;</span>)
<a name="l00587"></a>00587     {
<a name="l00588"></a>00588         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Configuring...&quot;</span>);
<a name="l00589"></a>00589         <span class="comment">// configure MSP430 connection type                            </span>
<a name="l00590"></a>00590         <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = MSP430_Configure(INTERFACE_MODE, value);
<a name="l00591"></a>00591         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> != STATUS_OK)
<a name="l00592"></a>00592         {
<a name="l00593"></a>00593             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_CONFIGURE, 0);
<a name="l00594"></a>00594         }
<a name="l00595"></a>00595     }
<a name="l00596"></a>00596     <span class="keywordflow">else</span>
<a name="l00597"></a>00597     {
<a name="l00598"></a>00598         <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = STATUS_OK;
<a name="l00599"></a>00599     }
<a name="l00600"></a>00600 }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602 <span class="comment">/*****************************************************************************/</span>
<a name="l00605"></a><a class="code" href="_std_use_case_8h.html#af7637c8a22d6b7252d5d7d433398fce3">00605</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#af7637c8a22d6b7252d5d7d433398fce3" title="Access device and read device information.">StdUseCase_GetDevice</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00606"></a>00606 {
<a name="l00607"></a>00607     <span class="keywordtype">char</span> c = 0;
<a name="l00608"></a>00608     <span class="keywordtype">int</span> k = 0;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610     <span class="comment">// if there are any &quot;wildcard&quot;-characters in the device name </span>
<a name="l00611"></a>00611     <span class="comment">// (e.g. MSP430G2xx1), make sure they are in lower case</span>
<a name="l00612"></a>00612     <span class="keywordflow">do</span>
<a name="l00613"></a>00613     {
<a name="l00614"></a>00614         c = sOpt-&gt;pcDeviceName[k];
<a name="l00615"></a>00615         <span class="keywordflow">if</span>(c == <span class="charliteral">&#39;X&#39;</span>)
<a name="l00616"></a>00616         {
<a name="l00617"></a>00617             sOpt-&gt;pcDeviceName[k] = <span class="charliteral">&#39;x&#39;</span>;
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619         k++;
<a name="l00620"></a>00620     }
<a name="l00621"></a>00621     <span class="keywordflow">while</span>(c != <span class="charliteral">&#39;\0&#39;</span>);
<a name="l00622"></a>00622 
<a name="l00623"></a>00623     <span class="comment">// try to open the device with the device name specified by the user</span>
<a name="l00624"></a>00624     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Accessing device...&quot;</span>);
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     <a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> = MSP430_OpenDevice(sOpt-&gt;pcDeviceName,sOpt-&gt;pcPassword,sOpt-&gt;pcPWlen,<a class="code" href="_m_s_p430___flasher_8cpp.html#abaebf859b60de1e16ec5c94063985ea5" title="Default options.">g_Def</a>.deviceAC,DEVICE_UNKNOWN);                                 
<a name="l00627"></a>00627     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> == STATUS_OK)
<a name="l00628"></a>00628     {
<a name="l00629"></a>00629         <span class="comment">// if device was opened successfully, read out device information</span>
<a name="l00630"></a>00630         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Reading device information...&quot;</span>);
<a name="l00631"></a>00631 
<a name="l00632"></a>00632         <a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> = MSP430_GetFoundDevice( (CHAR*)&amp;<a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.endian, <span class="keyword">sizeof</span>(<a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.buffer));
<a name="l00633"></a>00633         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> != STATUS_OK)
<a name="l00634"></a>00634         {
<a name="l00635"></a>00635             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_OPENDEVICE, 0);
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637     }
<a name="l00638"></a>00638     <span class="keywordflow">else</span>
<a name="l00639"></a>00639     {
<a name="l00640"></a>00640         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_OPENDEVICE, 0);
<a name="l00641"></a>00641     }
<a name="l00642"></a>00642     <span class="comment">// if -n switch is used</span>
<a name="l00643"></a>00643     <span class="keywordflow">if</span>(strcmp(sOpt-&gt;pcDeviceName, <span class="stringliteral">&quot;Unknown&quot;</span>) != 0)
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645         <span class="comment">// check if selected and found device matches</span>
<a name="l00646"></a>00646         <span class="keywordflow">if</span>(strcmp((<span class="keywordtype">char</span>*)<a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.string, sOpt-&gt;pcDeviceName) != 0)
<a name="l00647"></a>00647         {
<a name="l00648"></a>00648             <span class="comment">// in case of wildcard characters in the FETSTRING (MSPDS-internal device name)</span>
<a name="l00649"></a>00649             <span class="keywordflow">if</span>(strstr(<span class="stringliteral">&quot;x&quot;</span>, (<span class="keywordtype">char</span>*)<a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.string) != NULL)
<a name="l00650"></a>00650             {
<a name="l00651"></a>00651                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Warning: Found device might not match -n selection:\n&quot;</span>);
<a name="l00652"></a>00652             }
<a name="l00653"></a>00653             <span class="keywordflow">else</span>
<a name="l00654"></a>00654             {
<a name="l00655"></a>00655                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Error: Found device does not match -n selection:\n&quot;</span>);
<a name="l00656"></a>00656             }
<a name="l00657"></a>00657             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;- Selected: %s\n&quot;</span>, sOpt-&gt;pcDeviceName);
<a name="l00658"></a>00658             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;- Found:    %s\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.string);
<a name="l00659"></a>00659             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;- Omit -n switch to suppress this user prompt.\n&quot;</span>);
<a name="l00660"></a>00660             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;- Continue? (Y/N): &quot;</span>);
<a name="l00661"></a>00661 
<a name="l00662"></a>00662             <span class="keywordtype">char</span> Check_entry;
<a name="l00663"></a>00663 
<a name="l00664"></a>00664             cin  &gt;&gt; Check_entry;
<a name="l00665"></a>00665             cin.ignore();
<a name="l00666"></a>00666             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad86ef0ad08a24ecae8a2e95b350a7ca7" title="Log message.">LOG_MSG</a>, <span class="stringliteral">&quot;%c\n&quot;</span>, Check_entry);
<a name="l00667"></a>00667                         
<a name="l00668"></a>00668             <span class="keywordflow">if</span>(strchr(<span class="stringliteral">&quot;Yy&quot;</span>, Check_entry) == NULL)
<a name="l00669"></a>00669             {
<a name="l00670"></a>00670                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, 0);
<a name="l00671"></a>00671             }
<a name="l00672"></a>00672         }
<a name="l00673"></a>00673     }
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <span class="comment">/*****************************************************************************/</span>
<a name="l00682"></a><a class="code" href="_std_use_case_8h.html#afc35852077da0ac77f19bffe8e0ff5bd">00682</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#afc35852077da0ac77f19bffe8e0ff5bd" title="This function displays the results of the Flasher execution. It is also called whenever the execution...">StdUseCase_DisplayResults</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[], <a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00683"></a>00683 {
<a name="l00684"></a>00684     STATUS_T Ret;
<a name="l00685"></a>00685 
<a name="l00686"></a>00686     Ret = <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> | <a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd" title="Return value for MSP430_FET_GetFwVersion.">Ret_GetFwVersion</a> | <a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4" title="Return value for MSP430_FET_GetHwVersion.">Ret_GetHwVersion</a> | <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a> | <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> | <a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> | <a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a> | <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> | <a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd" title="Return value for MSP430_Reset.">Ret_Reset</a>;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>, <span class="stringliteral">&quot;* &quot;</span>);
<a name="l00689"></a>00689 
<a name="l00690"></a>00690     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l00691"></a>00691     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Arguments   : &quot;</span>);
<a name="l00692"></a>00692     <span class="keywordflow">for</span>(LONG p = 1; p &lt; argc; p++)
<a name="l00693"></a>00693     {
<a name="l00694"></a>00694         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a211f517156235b15bd46b2072363e83c" title="One line message.">ONE_LINE_MSG</a>, <span class="stringliteral">&quot;%s &quot;</span>,argv[p]);
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a211f517156235b15bd46b2072363e83c" title="One line message.">ONE_LINE_MSG</a>, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00697"></a>00697                 
<a name="l00698"></a>00698     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#ae1867e9c0f3d006c86e04df985f35bee" title="This flag is set whenever any default options were used due to an incomplete parameter list...">DEFAULT_OPTS</a>)
<a name="l00699"></a>00699     {
<a name="l00700"></a>00700         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Warning: Some default options were used due to incomplete argument list.\n&quot;</span>);
<a name="l00701"></a>00701     }
<a name="l00702"></a>00702     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l00703"></a>00703 
<a name="l00704"></a>00704     <span class="keywordflow">if</span>(Ret == STATUS_OK)
<a name="l00705"></a>00705     {
<a name="l00706"></a>00706         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Driver      : loaded\n&quot;</span>);
<a name="l00707"></a>00707         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Dll Version : %d\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a1c4a69268272c7421db156981127c9ab" title="Check value for DLL/FET-firmware compatibility.">lVersion</a>);
<a name="l00708"></a>00708         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* FwVersion   : %d\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a0ec8be96609f15e433d35a7725879041" title="FET firmware version number.">FWVersion</a>);
<a name="l00709"></a>00709         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Interface   : %s\n&quot;</span>, sOpt-&gt;pcInterface);
<a name="l00710"></a>00710         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* HwVersion   : %c %d.%d\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a>[0], <a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a>[3], <a class="code" href="_std_use_case_8cpp.html#a53a3b325ceefd278acd3f957b65a107c" title="Hardware version string.">HWVersion</a>[2]);
<a name="l00711"></a>00711         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* JTAG Mode   : %s\n&quot;</span>, sOpt-&gt;pcMode);
<a name="l00712"></a>00712         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Device      : %s\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.string);
<a name="l00713"></a>00713         <span class="comment">// print EEM implementation level of device</span>
<a name="l00714"></a>00714         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* EEM         : Level %d, ClockCntrl %d\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.emulation, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.clockControl);
<a name="l00715"></a>00715                 
<a name="l00716"></a>00716         <span class="keywordflow">if</span>(sOpt-&gt;pcReadFile != NULL)
<a name="l00717"></a>00717         {
<a name="l00718"></a>00718             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Read File   : %s (memory segment = %s)\n&quot;</span>, sOpt-&gt;pcReadFile, sOpt-&gt;pcReadMem);
<a name="l00719"></a>00719         }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721         <span class="keywordflow">if</span>(sOpt-&gt;pcFile != NULL)
<a name="l00722"></a>00722         {
<a name="l00723"></a>00723             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Prog.File   : %s (%s, verified = %s)\n&quot;</span>, sOpt-&gt;pcFile, sOpt-&gt;pcEraseType, sOpt-&gt;pcVerify);
<a name="l00724"></a>00724             
<a name="l00725"></a>00725             <span class="comment">// if BSL memory should be unlocked</span>
<a name="l00726"></a>00726             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a5ae752c4f91233e8623911fc21a48bc3" title="This flag is set if the BSL memory should be unlocked.">WRITE_BSL</a>)
<a name="l00727"></a>00727             {
<a name="l00728"></a>00728                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* BSL Unlock  : TRUE\n&quot;</span>);
<a name="l00729"></a>00729             }
<a name="l00730"></a>00730             <span class="keywordflow">else</span>
<a name="l00731"></a>00731             {
<a name="l00732"></a>00732                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* BSL Unlock  : FALSE\n&quot;</span>);
<a name="l00733"></a>00733             }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735             <span class="comment">// if INFO A memory should be unlocked                    </span>
<a name="l00736"></a>00736             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a2672cfa4187ccce0e8a00867c7ce6a13" title="This flag is set if the INFO A memory should be unlocked.">UNLOCK_FLASH</a>)
<a name="l00737"></a>00737             {
<a name="l00738"></a>00738                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* InfoA Access: TRUE\n&quot;</span>);
<a name="l00739"></a>00739             }
<a name="l00740"></a>00740             <span class="keywordflow">else</span>
<a name="l00741"></a>00741             {
<a name="l00742"></a>00742                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* InfoA Access: FALSE\n&quot;</span>);
<a name="l00743"></a>00743             }
<a name="l00744"></a>00744         }
<a name="l00745"></a>00745         <span class="keywordflow">if</span>(sOpt-&gt;pcVCC == 0)
<a name="l00746"></a>00746         {
<a name="l00747"></a>00747             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* VCC OFF\n&quot;</span>);
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749         <span class="keywordflow">else</span>
<a name="l00750"></a>00750         {
<a name="l00751"></a>00751             <span class="keywordflow">if</span>(strcmp(FETversion, <span class="stringliteral">&quot;E2.0&quot;</span>) == 0 || strcmp(FETversion, <span class="stringliteral">&quot;E3.0&quot;</span>) == 0 || strcmp(FETversion, <span class="stringliteral">&quot;E4.0&quot;</span>) == 0)
<a name="l00752"></a>00752             {
<a name="l00753"></a>00753                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* VCC ON      : 3000 mV\n&quot;</span>);
<a name="l00754"></a>00754             }
<a name="l00755"></a>00755             <span class="keywordflow">else</span>
<a name="l00756"></a>00756             {
<a name="l00757"></a>00757                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* VCC ON      : %d mV\n&quot;</span>, sOpt-&gt;pcVCC);
<a name="l00758"></a>00758             }
<a name="l00759"></a>00759         }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761         <span class="keywordflow">if</span>(sOpt-&gt;pcBreakpoints != NULL)
<a name="l00762"></a>00762         {
<a name="l00763"></a>00763             <span class="comment">// only if security fuse blow is not requested</span>
<a name="l00764"></a>00764             <span class="keywordflow">if</span>(!(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a7256c4cc2fdc7414d6c454f3e22125c1" title="This flag is set if JTAG fuse should be blown.">BLOW_FUSE</a>))
<a name="l00765"></a>00765             {
<a name="l00766"></a>00766                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Breakpoints : %d set\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#ac5178787362679f401728513abc2b1ab" title="Number of breakpoints.">BPcount</a>);
<a name="l00767"></a>00767                 <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a4a1c9c8f3fb759caf783429c48a0723b" title="This flag is set if the number of specified BP addresses exceeds the number of available hardware bre...">BP_LIMIT</a>)
<a name="l00768"></a>00768                 {
<a name="l00769"></a>00769                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* ATTENTION: Device supports %d Breakpoints. Further Breakpoints ignored.\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.nBreakpoints);
<a name="l00770"></a>00770                 }
<a name="l00771"></a>00771             }
<a name="l00772"></a>00772             <span class="keywordflow">else</span>
<a name="l00773"></a>00773             {
<a name="l00774"></a>00774                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>, <span class="stringliteral">&quot;* Breakpoints : Disabled due to JTAG fuse blow\n&quot;</span>);
<a name="l00775"></a>00775             }
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l00778"></a>00778     }
<a name="l00779"></a>00779     <span class="keywordflow">else</span>
<a name="l00780"></a>00780     {
<a name="l00781"></a>00781         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;  %d,%d,%d,%d,%d,%d,%d,%d,%d\n&quot;</span>, <a class="code" href="_std_use_case_8cpp.html#a992a91013dc4a48e463437adfc2f3270" title="Return value for MSP430_Initialize.">Ret_Initialize</a> , <a class="code" href="_std_use_case_8cpp.html#a07dcf6e0c12c0634ee7501ac48e387bd" title="Return value for MSP430_FET_GetFwVersion.">Ret_GetFwVersion</a> , <a class="code" href="_std_use_case_8cpp.html#afe48c59daf8ea4f078833ddecbc410f4" title="Return value for MSP430_FET_GetHwVersion.">Ret_GetHwVersion</a> , <a class="code" href="_std_use_case_8cpp.html#a6a5196d7bd2fff1d6227d5e7a5fdfad9" title="Return value for MSP430_VCC.">Ret_VCC</a> , <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> , <a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> , <a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a>, <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> , <a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd" title="Return value for MSP430_Reset.">Ret_Reset</a>);
<a name="l00782"></a>00782         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ERROR : %s\n&quot;</span>, MSP430_Error_String(<a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>));
<a name="l00783"></a>00783         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>);
<a name="l00784"></a>00784     }
<a name="l00785"></a>00785 }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="comment">/*****************************************************************************/</span>
<a name="l00791"></a><a class="code" href="_std_use_case_8h.html#a79ccdd595ac3b9be2049a025c079b442">00791</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a79ccdd595ac3b9be2049a025c079b442" title="Erase MSP430 memory. This function is only used in case an erase should be performed without writing ...">StdUseCase_Erase</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l00792"></a>00792 {
<a name="l00793"></a>00793     <span class="comment">// if memory should be erased without writing afterwards</span>
<a name="l00794"></a>00794     <span class="keywordflow">if</span>(sOpt-&gt;pcFile == NULL &amp;&amp; (<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a18f5c8f6a23e0b3b8f042893e07703d5" title="This flag is set if an erase operation should be performed without writing the memory afterwards...">ERASE_NO_WRITE</a>) &amp;&amp; strcmp(sOpt-&gt;pcEraseType, <span class="stringliteral">&quot;ERASE_TOTAL&quot;</span>) &amp;&amp; strcmp(sOpt-&gt;pcEraseType, <span class="stringliteral">&quot;ERASE_USER_CODE&quot;</span>))
<a name="l00795"></a>00795     {
<a name="l00796"></a>00796         LONG lEraseType = ERASE_ALL;
<a name="l00797"></a>00797         <span class="keywordtype">string</span> EraseType(sOpt-&gt;pcEraseType ? sOpt-&gt;pcEraseType : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799         <span class="keywordflow">if</span>(EraseType == <span class="stringliteral">&quot;ERASE_SEGMENT&quot;</span>)
<a name="l00800"></a>00800         {
<a name="l00801"></a>00801             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Warning: -e ERASE_SEGMENT must be used with -w switch. Command will be ignored.&quot;</span>);
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803         <span class="keywordflow">else</span>
<a name="l00804"></a>00804         {
<a name="l00805"></a>00805             <span class="keywordtype">string</span> DeviceName(sOpt-&gt;pcDeviceName ? sOpt-&gt;pcDeviceName : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00806"></a>00806 
<a name="l00807"></a>00807             <span class="keywordflow">if</span>(DeviceName == <span class="stringliteral">&quot;MSP430L092&quot;</span>)
<a name="l00808"></a>00808             {
<a name="l00809"></a>00809                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a4b4adcfae51a698016eb8616f4e15328" title="This flag is set if an MSP430L092 should be programmed.">L092_SELECTED</a>;
<a name="l00810"></a>00810                 sOpt-&gt;pcEraseType = <span class="stringliteral">&quot;ERASE_MAIN&quot;</span>;
<a name="l00811"></a>00811             }
<a name="l00812"></a>00812             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(DeviceName == <span class="stringliteral">&quot;MSP430C092&quot;</span>)
<a name="l00813"></a>00813             {
<a name="l00814"></a>00814                 sOpt-&gt;pcEraseType = <span class="stringliteral">&quot;ERASE_MAIN&quot;</span>;
<a name="l00815"></a>00815             }
<a name="l00816"></a>00816             <span class="keywordflow">if</span>(EraseType == <span class="stringliteral">&quot;ERASE_MAIN&quot;</span>)
<a name="l00817"></a>00817             {
<a name="l00818"></a>00818                 lEraseType = ERASE_MAIN;
<a name="l00819"></a>00819             }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Erasing device memory...&quot;</span>);
<a name="l00822"></a>00822 
<a name="l00823"></a>00823             <span class="keywordflow">if</span>(MSP430_Erase(lEraseType, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainStart, <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainEnd - <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainStart + 1) != STATUS_OK)
<a name="l00824"></a>00824             {
<a name="l00825"></a>00825                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Erase operation failed. Device memory was not erased correctly!\n&quot;</span>);
<a name="l00826"></a>00826                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_ERASE, 0);
<a name="l00827"></a>00827             }
<a name="l00828"></a>00828         }
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830 }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832 <span class="comment">/*****************************************************************************/</span>
<a name="l00836"></a><a class="code" href="_std_use_case_8h.html#a0812c4cb5c5752c2e80e232a65c08500">00836</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a0812c4cb5c5752c2e80e232a65c08500" title="Read and/or write MSP430 memory, verify file transfer.">StdUseCase_ReadWrite</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt, <a class="code" href="structs_r_t_e.html" title="Struct for runtime entries.">sRTE_t</a>* RTE)
<a name="l00837"></a>00837 {
<a name="l00838"></a>00838     <span class="keywordtype">string</span> DeviceName(sOpt-&gt;pcDeviceName ? sOpt-&gt;pcDeviceName : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00839"></a>00839     <span class="keywordtype">string</span> EraseType(sOpt-&gt;pcEraseType ? sOpt-&gt;pcEraseType : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00840"></a>00840     <span class="keywordtype">string</span> Verify(sOpt-&gt;pcVerify ? sOpt-&gt;pcVerify : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00841"></a>00841     <span class="keywordtype">string</span> ReadFile(sOpt-&gt;pcReadFile ? sOpt-&gt;pcReadFile : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00842"></a>00842     <span class="keywordtype">string</span> ReadMem(sOpt-&gt;pcReadMem ? sOpt-&gt;pcReadMem : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00843"></a>00843     ReadMem.erase(std::remove(ReadMem.begin(), ReadMem.end(), <span class="charliteral">&#39; &#39;</span>), ReadMem.end());
<a name="l00844"></a>00844 
<a name="l00845"></a>00845     <span class="keywordflow">if</span>(ReadFile != <span class="stringliteral">&quot;&quot;</span>)        <span class="comment">// if MSP430 memory should be dumped</span>
<a name="l00846"></a>00846     {
<a name="l00847"></a>00847         LONG lwStart;
<a name="l00848"></a>00848         LONG lwLength;
<a name="l00849"></a>00849                         
<a name="l00850"></a>00850         <span class="keywordflow">if</span>(ReadMem == <span class="stringliteral">&quot;RAM&quot;</span>)
<a name="l00851"></a>00851         {
<a name="l00852"></a>00852             lwStart = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.ramStart;
<a name="l00853"></a>00853             lwLength = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.ramEnd - <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.ramStart + 1;
<a name="l00854"></a>00854         }
<a name="l00855"></a>00855         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ReadMem == <span class="stringliteral">&quot;INFO&quot;</span>)
<a name="l00856"></a>00856         {
<a name="l00857"></a>00857             lwStart = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.infoStart;
<a name="l00858"></a>00858             lwLength = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.infoEnd - <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.infoStart + 1;
<a name="l00859"></a>00859                             
<a name="l00860"></a>00860             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>, <span class="stringliteral">&quot;* Unlocking Info Memory A...&quot;</span>);
<a name="l00861"></a>00861             <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = MSP430_Configure(LOCKED_FLASH_ACCESS, ENABLE);
<a name="l00862"></a>00862             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> == STATUS_ERROR)
<a name="l00863"></a>00863             {
<a name="l00864"></a>00864                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_CONFIGURE, 0);
<a name="l00865"></a>00865             }
<a name="l00866"></a>00866         }
<a name="l00867"></a>00867         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ReadMem == <span class="stringliteral">&quot;MAIN&quot;</span>)
<a name="l00868"></a>00868         {
<a name="l00869"></a>00869             lwStart = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainStart;
<a name="l00870"></a>00870             lwLength = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainEnd - <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainStart + 1;
<a name="l00871"></a>00871         }
<a name="l00872"></a>00872         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ReadMem == <span class="stringliteral">&quot;BSL&quot;</span>)
<a name="l00873"></a>00873         {
<a name="l00874"></a>00874             lwStart = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.bslStart;
<a name="l00875"></a>00875             lwLength = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.bslEnd - <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.bslStart + 1;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>, <span class="stringliteral">&quot;* Unlocking BSL memory...&quot;</span>);
<a name="l00878"></a>00878             <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = MSP430_Configure(UNLOCK_BSL_MODE, 1);
<a name="l00879"></a>00879             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> == STATUS_ERROR)
<a name="l00880"></a>00880             {
<a name="l00881"></a>00881                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_CONFIGURE, 0);
<a name="l00882"></a>00882             }
<a name="l00883"></a>00883         }
<a name="l00884"></a>00884         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ReadMem.find(<span class="stringliteral">&quot;0X&quot;</span>) != string::npos)
<a name="l00885"></a>00885         {
<a name="l00886"></a>00886             <span class="keywordtype">int</span> del_pos = ReadMem.find(<span class="stringliteral">&quot;-&quot;</span>);
<a name="l00887"></a>00887             lwStart = (LONG)strtol(ReadMem.substr(0, del_pos).c_str(), NULL, 16);
<a name="l00888"></a>00888             <span class="comment">/*if (lwStart % 2)</span>
<a name="l00889"></a>00889 <span class="comment">            {</span>
<a name="l00890"></a>00890 <span class="comment">                lwStart += 1;</span>
<a name="l00891"></a>00891 <span class="comment">                Print_N_Log(ERR_MSG, &quot;* Warning : Uneven start address. Using 0x%x instead.\n&quot;, lwStart);</span>
<a name="l00892"></a>00892 <span class="comment">            }*/</span>
<a name="l00893"></a>00893 
<a name="l00894"></a>00894             lwLength = (LONG)strtol(ReadMem.substr(del_pos+1, string::npos).c_str(), NULL, 16) - lwStart + 1;
<a name="l00895"></a>00895             <span class="keywordflow">if</span> (lwLength &lt;= 0)
<a name="l00896"></a>00896             {
<a name="l00897"></a>00897                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>, <span class="stringliteral">&quot;* ERROR : Invalid memory boundaries specified.\n&quot;</span>);
<a name="l00898"></a>00898                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_READOUTFILE, 0);
<a name="l00899"></a>00899             }      
<a name="l00900"></a>00900         }
<a name="l00901"></a>00901 
<a name="l00902"></a>00902         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Dumping memory from %s into %s...&quot;</span>, sOpt-&gt;pcReadMem, sOpt-&gt;pcReadFile);
<a name="l00903"></a>00903         <a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a> = MSP430_ReadOutFile(lwStart, lwLength, sOpt-&gt;pcReadFile, RTE-&gt;<a class="code" href="structs_r_t_e.html#af29da4b4c4e9a1c2207198011522eb89" title="For storing the type of the read file.">file_type</a>);
<a name="l00904"></a>00904         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a> != STATUS_OK)
<a name="l00905"></a>00905         {
<a name="l00906"></a>00906             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>, <span class="stringliteral">&quot;* ERROR : Unable to read from memory.\n&quot;</span>);
<a name="l00907"></a>00907             <span class="keywordflow">if</span> (lwLength &lt;= 0)
<a name="l00908"></a>00908             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_READOUTFILE, 0);
<a name="l00909"></a>00909         } 
<a name="l00910"></a>00910     }
<a name="l00911"></a>00911     <span class="keywordflow">else</span>
<a name="l00912"></a>00912     {
<a name="l00913"></a>00913         <a class="code" href="_std_use_case_8cpp.html#a3855baff4323e2e762324a643a9c6fcc" title="Return value for MSP430_MSP430_ReadOutFile.">Ret_ReadFile</a> = STATUS_OK;
<a name="l00914"></a>00914     }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916     <span class="comment">// if MSP430 memory should be programmed</span>
<a name="l00917"></a>00917     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> == STATUS_OK &amp;&amp; sOpt-&gt;pcFile != NULL)
<a name="l00918"></a>00918     {
<a name="l00919"></a>00919         <span class="comment">// if BSL write is enabled</span>
<a name="l00920"></a>00920         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> == STATUS_OK &amp;&amp; <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a5ae752c4f91233e8623911fc21a48bc3" title="This flag is set if the BSL memory should be unlocked.">WRITE_BSL</a>)
<a name="l00921"></a>00921         {                  
<a name="l00922"></a>00922             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>, <span class="stringliteral">&quot;* Unlocking BSL memory...&quot;</span>);
<a name="l00923"></a>00923             <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = MSP430_Configure(UNLOCK_BSL_MODE, ENABLE);
<a name="l00924"></a>00924             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> == STATUS_ERROR)
<a name="l00925"></a>00925             {
<a name="l00926"></a>00926                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_CONFIGURE, 0);
<a name="l00927"></a>00927             }
<a name="l00928"></a>00928         }
<a name="l00929"></a>00929 
<a name="l00930"></a>00930         <span class="comment">// if locked flash access is selected</span>
<a name="l00931"></a>00931         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#acffee1802ecb2e7616d1333237c1472b" title="Return value for MSP430_OpenDevice.">Ret_OpenDevice</a> == STATUS_OK &amp;&amp; <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a2672cfa4187ccce0e8a00867c7ce6a13" title="This flag is set if the INFO A memory should be unlocked.">UNLOCK_FLASH</a>)
<a name="l00932"></a>00932         {
<a name="l00933"></a>00933             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>, <span class="stringliteral">&quot;* Unlocking Info Memory A...&quot;</span>);
<a name="l00934"></a>00934             <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = MSP430_Configure(LOCKED_FLASH_ACCESS, ENABLE);
<a name="l00935"></a>00935             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> == STATUS_ERROR)
<a name="l00936"></a>00936             {
<a name="l00937"></a>00937                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_CONFIGURE, 0);
<a name="l00938"></a>00938             }
<a name="l00939"></a>00939         }
<a name="l00940"></a>00940                         
<a name="l00941"></a>00941         LONG lEraseType = ERASE_ALL;
<a name="l00942"></a>00942         LONG lVerify = <span class="keyword">false</span>;
<a name="l00943"></a>00943 
<a name="l00944"></a>00944         <span class="comment">// evaluate erase type</span>
<a name="l00945"></a>00945         <span class="comment">// only the L092 requires writing to external memory</span>
<a name="l00946"></a>00946         <span class="keywordflow">if</span>(DeviceName == <span class="stringliteral">&quot;MSP430L092&quot;</span>)
<a name="l00947"></a>00947         {
<a name="l00948"></a>00948             <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a4b4adcfae51a698016eb8616f4e15328" title="This flag is set if an MSP430L092 should be programmed.">L092_SELECTED</a>;
<a name="l00949"></a>00949             sOpt-&gt;pcEraseType = <span class="stringliteral">&quot;ERASE_MAIN&quot;</span>;
<a name="l00950"></a>00950         }
<a name="l00951"></a>00951         <span class="keywordflow">else</span>
<a name="l00952"></a>00952         <span class="keywordflow">if</span>(DeviceName == <span class="stringliteral">&quot;MSP430C092&quot;</span>)
<a name="l00953"></a>00953         {
<a name="l00954"></a>00954             sOpt-&gt;pcEraseType = <span class="stringliteral">&quot;ERASE_MAIN&quot;</span>;
<a name="l00955"></a>00955         }
<a name="l00956"></a>00956         <span class="keywordflow">if</span>(EraseType == <span class="stringliteral">&quot;ERASE_MAIN&quot;</span>)
<a name="l00957"></a>00957         {
<a name="l00958"></a>00958             lEraseType = ERASE_MAIN;
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960         <span class="keywordflow">if</span>(EraseType == <span class="stringliteral">&quot;ERASE_SEGMENT&quot;</span>)
<a name="l00961"></a>00961         {
<a name="l00962"></a>00962             STATUS_T RetVal = STATUS_ERROR;
<a name="l00963"></a>00963             
<a name="l00964"></a>00964             LONG lStartAddress = 0;
<a name="l00965"></a>00965             LONG lProgramLength = 0;
<a name="l00966"></a>00966             
<a name="l00967"></a>00967             lEraseType = ERASE_SEGMENT;
<a name="l00968"></a>00968             <span class="keywordflow">if</span>(<a class="code" href="_support_8cpp.html#aed237b4d30a13065509a6a3f1fe84b80" title="This function parses the input file containing the targetcode to determine start address and length o...">ParseInputFile</a>(sOpt-&gt;pcFile, &amp;lStartAddress, &amp;lProgramLength) != STATUS_OK)
<a name="l00969"></a>00969             {
<a name="l00970"></a>00970                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, 26); <span class="comment">// ErrorNumber 26 = &quot;File I/O Error&quot;</span>
<a name="l00971"></a>00971             }
<a name="l00972"></a>00972 
<a name="l00973"></a>00973             <span class="keywordflow">if</span>(MSP430_Erase(lEraseType, lStartAddress, lProgramLength) != STATUS_OK)
<a name="l00974"></a>00974             {
<a name="l00975"></a>00975                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Erase check failed. Memory segment was not erased correctly!\n&quot;</span>);
<a name="l00976"></a>00976                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_ERASE, 0);
<a name="l00977"></a>00977             }
<a name="l00978"></a>00978             
<a name="l00979"></a>00979             <span class="keywordflow">if</span>(MSP430_EraseCheck(lStartAddress, lProgramLength) != STATUS_OK)
<a name="l00980"></a>00980             {
<a name="l00981"></a>00981                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Erase check failed. Memory segment was not erased correctly!\n&quot;</span>);
<a name="l00982"></a>00982                 <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_ERASE, 0);
<a name="l00983"></a>00983             }
<a name="l00984"></a>00984         }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986         <span class="comment">// evaluate verify option</span>
<a name="l00987"></a>00987         <span class="keywordflow">if</span>(Verify == <span class="stringliteral">&quot;TRUE&quot;</span>)
<a name="l00988"></a>00988         {
<a name="l00989"></a>00989             lVerify = TRUE;
<a name="l00990"></a>00990         }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Loading file into device...&quot;</span>);
<a name="l00993"></a>00993         <span class="comment">// program target code into MSP430 memory</span>
<a name="l00994"></a>00994         <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> = MSP430_ProgramFile(sOpt-&gt;pcFile, lEraseType, lVerify);
<a name="l00995"></a>00995         <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> = MSP430_Error_Number();
<a name="l00996"></a>00996 
<a name="l00997"></a>00997         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> == STATUS_OK)
<a name="l00998"></a>00998         {
<a name="l00999"></a>00999             <span class="keywordflow">if</span>(lVerify == TRUE)
<a name="l01000"></a>01000             {
<a name="l01001"></a>01001                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Verifying transfer...&quot;</span>);
<a name="l01002"></a>01002                 <span class="comment">// does the content of the memory and the file match?</span>
<a name="l01003"></a>01003                 <a class="code" href="_std_use_case_8cpp.html#a77065358bd3e03f6a1be294e552d7edf" title="Return value for MSP430_VerifyFile.">Ret_VerifyFile</a> = MSP430_VerifyFile(sOpt-&gt;pcFile);
<a name="l01004"></a>01004                 <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a> = MSP430_Error_Number();
<a name="l01005"></a>01005             }
<a name="l01006"></a>01006         }
<a name="l01007"></a>01007         <span class="keywordflow">else</span>
<a name="l01008"></a>01008         {
<a name="l01009"></a>01009             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ERROR : %s\n&quot;</span>, MSP430_Error_String(<a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>));
<a name="l01010"></a>01010             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Unable to load file.\n&quot;</span>);
<a name="l01011"></a>01011                             
<a name="l01012"></a>01012             <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> = STATUS_ERROR;
<a name="l01013"></a>01013             <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>;
<a name="l01014"></a>01014         }
<a name="l01015"></a>01015     }
<a name="l01016"></a>01016     <span class="keywordflow">else</span>
<a name="l01017"></a>01017     {
<a name="l01018"></a>01018         <a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> = STATUS_OK;  <span class="comment">// &lt;- simply set status to OK</span>
<a name="l01019"></a>01019     }
<a name="l01020"></a>01020     <span class="keywordflow">if</span> ((<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a8c65acac312a18b1057da8805da051b8" title="This flag is set if external memory should be written.">WRITE_EXT_MEM</a>) &amp;&amp; (<a class="code" href="_std_use_case_8cpp.html#a189b71a9000740460f082da636e1d707" title="Return value for MSP430_ProgramFile.">Ret_ProgramFile</a> != STATUS_ERROR))
<a name="l01021"></a>01021     {
<a name="l01022"></a>01022         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Writing to external memory...&quot;</span>);
<a name="l01023"></a>01023         <a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> = MSP430_Configure(WRITE_EXTERNAL_MEMORY, ENABLE);        <span class="comment">// write to external memory</span>
<a name="l01024"></a>01024         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a9412fbb3c20dcb710a1796f2d4ac724e" title="Return value for MSP430_Configure.">Ret_Configure</a> == STATUS_ERROR)
<a name="l01025"></a>01025         {
<a name="l01026"></a>01026             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_CONFIGURE, 0);
<a name="l01027"></a>01027         }
<a name="l01028"></a>01028     }
<a name="l01029"></a>01029 }
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="comment">/*****************************************************************************/</span>
<a name="l01034"></a><a class="code" href="_std_use_case_8h.html#a001f13af0b42962a34d01e6b4b56f469">01034</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a001f13af0b42962a34d01e6b4b56f469" title="If triggered by -f switch, this function blows the device&#39;s security fuse.">StdUseCase_BlowFuse</a>(<span class="keywordtype">void</span>)
<a name="l01035"></a>01035 {
<a name="l01036"></a>01036     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a7256c4cc2fdc7414d6c454f3e22125c1" title="This flag is set if JTAG fuse should be blown.">BLOW_FUSE</a>)
<a name="l01037"></a>01037     {
<a name="l01038"></a>01038         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Blowing JTAG Fuse...&quot;</span>);
<a name="l01039"></a>01039 
<a name="l01040"></a>01040         <span class="keywordflow">if</span>(MSP430_Secure() != STATUS_OK)
<a name="l01041"></a>01041         <span class="comment">/*{</span>
<a name="l01042"></a>01042 <span class="comment">            Print_N_Log(REPORT_MSG, &quot;&quot;);</span>
<a name="l01043"></a>01043 <span class="comment">        }</span>
<a name="l01044"></a>01044 <span class="comment">        else*/</span>
<a name="l01045"></a>01045         {
<a name="l01046"></a>01046             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Security fuse could not be blown!\n&quot;</span>);
<a name="l01047"></a>01047             <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, 0);
<a name="l01048"></a>01048         }
<a name="l01049"></a>01049     }
<a name="l01050"></a>01050 }
<a name="l01051"></a>01051 
<a name="l01052"></a>01052 <span class="comment">/*****************************************************************************/</span>
<a name="l01059"></a><a class="code" href="_std_use_case_8h.html#ad0c4ff8efa7baf691230ca976288bae5">01059</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#ad0c4ff8efa7baf691230ca976288bae5" title="This function sets hardware breakpoints.">StdUseCase_SetBreakpoints</a>(LONG *AddrArray)
<a name="l01060"></a>01060 { 
<a name="l01061"></a>01061     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a7256c4cc2fdc7414d6c454f3e22125c1" title="This flag is set if JTAG fuse should be blown.">BLOW_FUSE</a>)
<a name="l01062"></a>01062     {
<a name="l01063"></a>01063         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Breakpoints disabled. Fuse blow was requested.&quot;</span>);
<a name="l01064"></a>01064     }
<a name="l01065"></a>01065     <span class="keywordflow">else</span>
<a name="l01066"></a>01066     {
<a name="l01067"></a>01067         BpParameter_t pBpBuffer;
<a name="l01068"></a>01068 
<a name="l01069"></a>01069         WORD  pwBpHandle = 0;    <span class="comment">// breakpoint handle, initialized with &#39;0&#39;</span>
<a name="l01070"></a>01070         LONG BPLocal[50] = {0};
<a name="l01071"></a>01071   
<a name="l01072"></a>01072         <span class="keywordtype">signed</span> <span class="keywordtype">int</span> Addrcount = 0;
<a name="l01073"></a>01073         <span class="keywordtype">int</span> invalid = 0;
<a name="l01074"></a>01074         <span class="keywordtype">int</span> tempcount = 0;
<a name="l01075"></a>01075         <span class="keywordtype">int</span> localcount;
<a name="l01076"></a>01076         BOOL BPflag = FALSE;
<a name="l01077"></a>01077         BOOL Addrflag = FALSE;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079         <a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41" title="Return value for MSP430_MSP430_EEM_SetBreakpoint.">Ret_Breakpoints</a> = STATUS_ERROR;
<a name="l01080"></a>01080 
<a name="l01081"></a>01081         pBpBuffer.bpMode = BP_CODE;
<a name="l01082"></a>01082         pBpBuffer.bpType = BP_MAB;
<a name="l01083"></a>01083         pBpBuffer.bpAccess = BP_FETCH;
<a name="l01084"></a>01084         pBpBuffer.bpAction = BP_BRK;
<a name="l01085"></a>01085         pBpBuffer.bpOperat = BP_EQUAL;
<a name="l01086"></a>01086         pBpBuffer.lMask = 0xFFFFF;
<a name="l01087"></a>01087 
<a name="l01088"></a>01088         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Setting Breakpoints...&quot;</span>);
<a name="l01089"></a>01089 
<a name="l01090"></a>01090         <span class="keywordflow">if</span>(AddrArray[Addrcount] != 0)
<a name="l01091"></a>01091         {
<a name="l01092"></a>01092             <span class="keywordflow">for</span>(localcount = 0; AddrArray[localcount] != 0; localcount++)
<a name="l01093"></a>01093             {
<a name="l01094"></a>01094                 BPLocal[localcount] = AddrArray[localcount];
<a name="l01095"></a>01095             }
<a name="l01096"></a>01096             BPLocal[localcount] = 0;
<a name="l01097"></a>01097             BPflag = TRUE;
<a name="l01098"></a>01098         }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100         <span class="keywordflow">while</span>(BPLocal[Addrcount] != 0)
<a name="l01101"></a>01101         {
<a name="l01102"></a>01102             <span class="keywordflow">if</span>(Addrcount &lt;= <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.nBreakpoints)
<a name="l01103"></a>01103             {
<a name="l01104"></a>01104                 pwBpHandle = 0;
<a name="l01105"></a>01105                 <span class="keywordflow">if</span>((BPLocal[Addrcount] &lt; <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainStart) || (BPLocal[Addrcount] &gt; (<span class="keywordtype">long</span>)<a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.mainEnd))
<a name="l01106"></a>01106                 {
<a name="l01107"></a>01107                     tempcount = Addrcount;
<a name="l01108"></a>01108                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>, <span class="stringliteral">&quot;* Error creating breakpoint @ 0x%x: invalid address!\n&quot;</span>, BPLocal[Addrcount]);
<a name="l01109"></a>01109                     <span class="keywordflow">if</span>(BPLocal[Addrcount+1] == 0)
<a name="l01110"></a>01110                     {
<a name="l01111"></a>01111                         BPLocal[Addrcount] = 0;
<a name="l01112"></a>01112                     }
<a name="l01113"></a>01113                     <span class="keywordflow">while</span>(BPLocal[tempcount] != 0)
<a name="l01114"></a>01114                     {
<a name="l01115"></a>01115                         BPLocal[tempcount] = BPLocal[tempcount+1];
<a name="l01116"></a>01116                         tempcount++;
<a name="l01117"></a>01117                     }
<a name="l01118"></a>01118                     invalid++;
<a name="l01119"></a>01119                     Addrflag = TRUE;
<a name="l01120"></a>01120                 }
<a name="l01121"></a>01121                 <span class="keywordflow">else</span>
<a name="l01122"></a>01122                 {
<a name="l01123"></a>01123                     pBpBuffer.lAddrVal = BPLocal[Addrcount];
<a name="l01124"></a>01124                     MSP430_EEM_SetBreakpoint(&amp;pwBpHandle,&amp;pBpBuffer);
<a name="l01125"></a>01125                 }
<a name="l01126"></a>01126             }
<a name="l01127"></a>01127             <span class="keywordflow">if</span>(Addrcount == <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.nBreakpoints-1)
<a name="l01128"></a>01128             {
<a name="l01129"></a>01129                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a4a1c9c8f3fb759caf783429c48a0723b" title="This flag is set if the number of specified BP addresses exceeds the number of available hardware bre...">BP_LIMIT</a>;
<a name="l01130"></a>01130                 <a class="code" href="_std_use_case_8cpp.html#ac5178787362679f401728513abc2b1ab" title="Number of breakpoints.">BPcount</a> = <a class="code" href="_std_use_case_8cpp.html#a9d17f42c18af28e98037e3037cc70977" title="Struct for target device information.">g_tTargetDevice</a>.nBreakpoints;
<a name="l01131"></a>01131             }
<a name="l01132"></a>01132             <span class="keywordflow">if</span>(!Addrflag)
<a name="l01133"></a>01133                 Addrcount++;
<a name="l01134"></a>01134             Addrflag = FALSE;
<a name="l01135"></a>01135         }
<a name="l01136"></a>01136         <a class="code" href="_std_use_case_8cpp.html#ac5178787362679f401728513abc2b1ab" title="Number of breakpoints.">BPcount</a> -= invalid;
<a name="l01137"></a>01137         <span class="keywordflow">if</span>(BPflag)
<a name="l01138"></a>01138         {
<a name="l01139"></a>01139             <span class="keywordflow">for</span>(localcount = 0; BPLocal[localcount] != 0; localcount++)
<a name="l01140"></a>01140             {
<a name="l01141"></a>01141                 AddrArray[localcount] = BPLocal[localcount];
<a name="l01142"></a>01142             }
<a name="l01143"></a>01143         }
<a name="l01144"></a>01144     }
<a name="l01145"></a>01145 }
<a name="l01146"></a>01146 
<a name="l01147"></a>01147 <span class="comment">/*****************************************************************************/</span>
<a name="l01156"></a><a class="code" href="_std_use_case_8h.html#ae9e6877674ab11308eb9c70626ae922e">01156</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#ae9e6877674ab11308eb9c70626ae922e" title="Execute the program in the target memory.">StdUseCase_RunProgram</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt, LONG* AddrArray)
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158     STATUS_T RetState;
<a name="l01159"></a>01159 
<a name="l01160"></a>01160     <span class="comment">// if breakpoints are set and fuse blow is not requested</span>
<a name="l01161"></a>01161     <span class="keywordflow">if</span>(sOpt-&gt;pcBreakpoints != NULL &amp;&amp; !(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a7256c4cc2fdc7414d6c454f3e22125c1" title="This flag is set if JTAG fuse should be blown.">BLOW_FUSE</a>))
<a name="l01162"></a>01162     {
<a name="l01163"></a>01163         <span class="keywordtype">int</span> BPnumber = 1;
<a name="l01164"></a>01164         <span class="keywordtype">int</span> runcount = 1;
<a name="l01165"></a>01165 
<a name="l01166"></a>01166         <span class="keywordflow">while</span>(runcount &lt;= <a class="code" href="_std_use_case_8cpp.html#ac5178787362679f401728513abc2b1ab" title="Number of breakpoints.">BPcount</a>)
<a name="l01167"></a>01167         {
<a name="l01168"></a>01168             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Running Program in RUN_TO_BREAKPOINT mode...\n&quot;</span>);
<a name="l01169"></a>01169 
<a name="l01170"></a>01170             <a class="code" href="_std_use_case_8cpp.html#a3c7974343a33a0806e8fb53104550cc9" title="Start the program execution.">StdUseCase_Run</a>();
<a name="l01171"></a>01171 
<a name="l01172"></a>01172             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a4c4db3ac43346e02173b69bc9895f2fd" title="Wait for specific event.">StdUseCase_WaitForEvent</a>(WM_BpMESSAGE, strtol(sOpt-&gt;pcTimeout, NULL, 10)))
<a name="l01173"></a>01173             {
<a name="l01174"></a>01174                 RetState = STATUS_ERROR;
<a name="l01175"></a>01175                 RetState = MSP430_Registers(<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>, ALL_REGS, READ);  <span class="comment">//update registers</span>
<a name="l01176"></a>01176                 <span class="keywordflow">if</span> (RetState != STATUS_OK)
<a name="l01177"></a>01177                 {
<a name="l01178"></a>01178                     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot; ERROR: MSP430_Registers(..., ALL_REGS, READ)\n&quot;</span>);
<a name="l01179"></a>01179                     <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_REGISTER_READ, 0);
<a name="l01180"></a>01180                 }
<a name="l01181"></a>01181     
<a name="l01182"></a>01182                 <span class="keywordflow">while</span>((<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[PC] != AddrArray[BPnumber-1]))  <span class="comment">//determine breakpoint number</span>
<a name="l01183"></a>01183                 {                                                                
<a name="l01184"></a>01184                     BPnumber++;
<a name="l01185"></a>01185                     <span class="keywordflow">if</span>(BPnumber &gt; <a class="code" href="_std_use_case_8cpp.html#ac5178787362679f401728513abc2b1ab" title="Number of breakpoints.">BPcount</a>)
<a name="l01186"></a>01186                     {    
<a name="l01187"></a>01187                         BPnumber = 1;
<a name="l01188"></a>01188                     }
<a name="l01189"></a>01189                 }
<a name="l01190"></a>01190                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Hit breakpoint #%d @ 0x%x...\n&quot;</span>,BPnumber, <a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[PC]);
<a name="l01191"></a>01191                 
<a name="l01192"></a>01192                 <a class="code" href="_std_use_case_8cpp.html#a9d7714cc902af6d74d47a28509384092" title="This function clears a single hardware breakpoint.">StdUseCase_ClearBreakpoint</a>(&amp;AddrArray[0], BPnumber);
<a name="l01193"></a>01193 
<a name="l01194"></a>01194                 <a class="code" href="_std_use_case_8cpp.html#a956d9ea54e17776013f1700271d2939b" title="This function reads all CPU registers and prints/logs their content.">StdUseCase_GetCpuState</a>();
<a name="l01195"></a>01195             }
<a name="l01196"></a>01196             runcount++;
<a name="l01197"></a>01197         }
<a name="l01198"></a>01198     }
<a name="l01199"></a>01199 }
<a name="l01200"></a>01200 
<a name="l01201"></a>01201 <span class="comment">/*****************************************************************************/</span>
<a name="l01208"></a><a class="code" href="_std_use_case_8h.html#a9d7714cc902af6d74d47a28509384092">01208</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a9d7714cc902af6d74d47a28509384092" title="This function clears a single hardware breakpoint.">StdUseCase_ClearBreakpoint</a>(LONG *AddrArray, <span class="keywordtype">int</span> number)
<a name="l01209"></a>01209 {
<a name="l01210"></a>01210     <a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41" title="Return value for MSP430_MSP430_EEM_SetBreakpoint.">Ret_Breakpoints</a> = STATUS_ERROR;
<a name="l01211"></a>01211     
<a name="l01212"></a>01212     BpParameter_t    pBpBuffer;
<a name="l01213"></a>01213     WORD  pwBpHandle = 0;            <span class="comment">// breakpoint handle, initialized with &#39;0&#39;</span>
<a name="l01214"></a>01214 
<a name="l01215"></a>01215     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Clearing Breakpoint #%d...&quot;</span>, number);
<a name="l01216"></a>01216 
<a name="l01217"></a>01217     pBpBuffer.bpMode = BP_CLEAR;
<a name="l01218"></a>01218     pBpBuffer.lAddrVal = AddrArray[number-1];
<a name="l01219"></a>01219     pwBpHandle = (WORD)(number);
<a name="l01220"></a>01220 
<a name="l01221"></a>01221     <a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41" title="Return value for MSP430_MSP430_EEM_SetBreakpoint.">Ret_Breakpoints</a> = MSP430_EEM_SetBreakpoint(&amp;pwBpHandle,&amp;pBpBuffer);
<a name="l01222"></a>01222     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#a7c4799bcd9fec59a7d75f42392224c41" title="Return value for MSP430_MSP430_EEM_SetBreakpoint.">Ret_Breakpoints</a> != STATUS_OK)
<a name="l01223"></a>01223     {
<a name="l01224"></a>01224         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_EEM_SETBREAKPOINT, 0);
<a name="l01225"></a>01225     }
<a name="l01226"></a>01226 }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228 <span class="comment">/*****************************************************************************/</span>
<a name="l01229"></a>01229 <span class="comment">/*****************************************************************************/</span>
<a name="l01234"></a>01234 <span class="comment">/*****************************************************************************/</span>
<a name="l01235"></a>01235 <span class="comment">/*****************************************************************************/</span>
<a name="l01236"></a>01236 
<a name="l01237"></a><a class="code" href="_std_use_case_8cpp.html#aa94b6f0939819287a0c60532f726d63c">01237</a> <span class="keyword">const</span> LONG <a class="code" href="_std_use_case_8cpp.html#aa94b6f0939819287a0c60532f726d63c">EemClientHandle</a> = 1;
<a name="l01238"></a>01238 LONG   bpEventFlags = 0;
<a name="l01239"></a>01239 <a class="code" href="class_event.html">Event</a> MyEvent;
<a name="l01240"></a>01240 <a class="code" href="class_event.html">Event</a> MyBpEvent;
<a name="l01241"></a>01241 <a class="code" href="class_event.html">Event</a> MySsEvent;
<a name="l01242"></a>01242 <a class="code" href="class_event.html">Event</a> MyStoEvent;
<a name="l01243"></a>01243 <a class="code" href="class_event.html">Event</a> MySStateEvent;
<a name="l01244"></a>01244 <a class="code" href="class_event.html">Event</a> MyCPUStopEvent;
<a name="l01245"></a>01245 
<a name="l01246"></a>01246 LONG   ValueParam;
<a name="l01247"></a>01247 UINT   MyGlob_MsgId;
<a name="l01248"></a>01248 UINT MyGlob_wParam;
<a name="l01249"></a>01249 LONG MyGlob_lParam;
<a name="l01250"></a>01250 
<a name="l01251"></a>01251 <span class="comment">/*****************************************************************************/</span>
<a name="l01257"></a><a class="code" href="_std_use_case_8cpp.html#ade1e7097132e0a190989a099e06b9e8a">01257</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#ade1e7097132e0a190989a099e06b9e8a" title="Notify callback function for MSP430.dll PostMessages.">MY_DLL430_CallbackFunc</a>(UINT MsgId, UINT wParam, LONG lParam, LONG clientHandle)
<a name="l01258"></a>01258 {
<a name="l01259"></a>01259     ValueParam = lParam;
<a name="l01260"></a>01260     MyGlob_MsgId = MsgId;
<a name="l01261"></a>01261     MyGlob_wParam = wParam;
<a name="l01262"></a>01262     MyGlob_lParam = lParam;
<a name="l01263"></a>01263 
<a name="l01264"></a>01264     <span class="keywordflow">switch</span>(MsgId)
<a name="l01265"></a>01265     {
<a name="l01266"></a>01266     <span class="keywordflow">case</span> WM_BpMESSAGE:
<a name="l01267"></a>01267         bpEventFlags |= fBpMESSAGE;
<a name="l01268"></a>01268         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; MESSAGE: Breakpoint hit...\n&quot;</span>);
<a name="l01269"></a>01269         MyBpEvent.set();
<a name="l01270"></a>01270         MyEvent.set();
<a name="l01271"></a>01271         <span class="keywordflow">break</span>;
<a name="l01272"></a>01272     <span class="keywordflow">case</span> WM_SsMESSAGE:
<a name="l01273"></a>01273         bpEventFlags |= fSsMESSAGE;
<a name="l01274"></a>01274         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; MESSAGE: Single step complete...\n&quot;</span>);
<a name="l01275"></a>01275         MySsEvent.set();
<a name="l01276"></a>01276         MyEvent.set();
<a name="l01277"></a>01277         <span class="keywordflow">break</span>;
<a name="l01278"></a>01278     <span class="keywordflow">case</span> WM_StoMESSAGE:
<a name="l01279"></a>01279         bpEventFlags |= fStoMESSAGE;
<a name="l01280"></a>01280         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; MESSAGE: Storage on trace buffer...\n&quot;</span>);
<a name="l01281"></a>01281         <a class="code" href="_std_use_case_8cpp.html#a401ecd4364d7f8f6f6458ac3714f4306" title="Read the state storage buffer.">StdUseCase_EemReadStateStorageBuffer</a>(wParam);
<a name="l01282"></a>01282         MyStoEvent.set();
<a name="l01283"></a>01283         MyEvent.set();
<a name="l01284"></a>01284         <span class="keywordflow">break</span>;
<a name="l01285"></a>01285     <span class="keywordflow">case</span> WM_SStateMESSAGE:
<a name="l01286"></a>01286         bpEventFlags |= fSStateMESSAGE;
<a name="l01287"></a>01287         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; MESSAGE: Change in new state of the sequencer...\n&quot;</span>);
<a name="l01288"></a>01288         MySStateEvent.set();
<a name="l01289"></a>01289         MyEvent.set();
<a name="l01290"></a>01290         <span class="keywordflow">break</span>;
<a name="l01291"></a>01291     <span class="keywordflow">case</span> WM_WarMESSAGE:
<a name="l01292"></a>01292         bpEventFlags |= fWarMESSAGE;
<a name="l01293"></a>01293         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; WARNING: Postmessage warning from DLL...\n&quot;</span>);
<a name="l01294"></a>01294         <span class="keywordflow">break</span>;
<a name="l01295"></a>01295     <span class="keywordflow">case</span> WM_CPUStopMESSAGE:
<a name="l01296"></a>01296         bpEventFlags |= fCPUStopMESSAGE;
<a name="l01297"></a>01297         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot; MESSAGE: Device CPU stopped...\n&quot;</span>);
<a name="l01298"></a>01298         MyCPUStopEvent.set();
<a name="l01299"></a>01299         MyEvent.set();
<a name="l01300"></a>01300         <span class="keywordflow">break</span>;
<a name="l01301"></a>01301     <span class="keywordflow">default</span>:
<a name="l01302"></a>01302         <span class="keywordflow">break</span>;
<a name="l01303"></a>01303     }
<a name="l01304"></a>01304 }
<a name="l01305"></a>01305 
<a name="l01306"></a>01306 <span class="comment">/*****************************************************************************/</span>
<a name="l01308"></a><a class="code" href="_std_use_case_8h.html#a01ad9120a5921fefe1204f231ecceebd">01308</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a01ad9120a5921fefe1204f231ecceebd" title="Initialize the Enhanced Emulation Module (EEM)">StdUseCase_EemInit</a>(<span class="keywordtype">void</span>)
<a name="l01309"></a>01309 {
<a name="l01310"></a>01310     STATUS_T    RetState = STATUS_ERROR;
<a name="l01311"></a>01311     MessageID_t MsgId;
<a name="l01312"></a>01312 
<a name="l01313"></a>01313     MsgId.uiMsgIdBreakpoint = WM_BpMESSAGE;
<a name="l01314"></a>01314     MsgId.uiMsgIdSingleStep = WM_SsMESSAGE;
<a name="l01315"></a>01315     MsgId.uiMsgIdStorage    = WM_StoMESSAGE;
<a name="l01316"></a>01316     MsgId.uiMsgIdState      = WM_SStateMESSAGE;
<a name="l01317"></a>01317     MsgId.uiMsgIdWarning    = WM_WarMESSAGE;
<a name="l01318"></a>01318     MsgId.uiMsgIdCPUStopped = WM_CPUStopMESSAGE;
<a name="l01319"></a>01319     
<a name="l01320"></a>01320     <span class="comment">// initialize EEM, assign callback function, handlernumber and msgstruct</span>
<a name="l01321"></a>01321     RetState = MSP430_EEM_Init(<a class="code" href="_std_use_case_8cpp.html#ade1e7097132e0a190989a099e06b9e8a" title="Notify callback function for MSP430.dll PostMessages.">MY_DLL430_CallbackFunc</a>, <a class="code" href="_std_use_case_8cpp.html#aa94b6f0939819287a0c60532f726d63c">EemClientHandle</a>, &amp;MsgId);
<a name="l01322"></a>01322     <span class="keywordflow">if</span> (RetState == STATUS_OK)
<a name="l01323"></a>01323     {
<a name="l01324"></a>01324         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Initializing EEM...&quot;</span>);
<a name="l01325"></a>01325     }
<a name="l01326"></a>01326     <span class="keywordflow">else</span>
<a name="l01327"></a>01327     {
<a name="l01328"></a>01328         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_EEM_INIT, 0);
<a name="l01329"></a>01329     }
<a name="l01330"></a>01330 }
<a name="l01331"></a>01331 
<a name="l01332"></a>01332 <span class="comment">/*****************************************************************************/</span>
<a name="l01334"></a><a class="code" href="_std_use_case_8h.html#a3c7974343a33a0806e8fb53104550cc9">01334</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a3c7974343a33a0806e8fb53104550cc9" title="Start the program execution.">StdUseCase_Run</a>(<span class="keywordtype">void</span>)
<a name="l01335"></a>01335 {
<a name="l01336"></a>01336     <a class="code" href="_std_use_case_8cpp.html#a281df3aa4e2d2e077fb1268a5a7f0386" title="Return value for MSP430_Run.">Ret_Run</a> = MSP430_Run(RUN_TO_BREAKPOINT, FALSE);
<a name="l01337"></a>01337     <span class="keywordflow">if</span> (<a class="code" href="_std_use_case_8cpp.html#a281df3aa4e2d2e077fb1268a5a7f0386" title="Return value for MSP430_Run.">Ret_Run</a> != STATUS_OK)
<a name="l01338"></a>01338     {
<a name="l01339"></a>01339         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_RUN, 0);
<a name="l01340"></a>01340     }
<a name="l01341"></a>01341 }
<a name="l01342"></a>01342 
<a name="l01343"></a>01343 <span class="comment">/*****************************************************************************/</span>
<a name="l01346"></a><a class="code" href="_std_use_case_8h.html#a768500206aabaa5b03a970c8da3ad7d5">01346</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a768500206aabaa5b03a970c8da3ad7d5" title="Stop the target CPU.">StdUseCase_EemStop</a>(<span class="keywordtype">void</span>)
<a name="l01347"></a>01347 {
<a name="l01348"></a>01348     STATUS_T RetState;
<a name="l01349"></a>01349 
<a name="l01350"></a>01350     RetState = STATUS_ERROR;
<a name="l01351"></a>01351 
<a name="l01352"></a>01352     LONG lState;
<a name="l01353"></a>01353 
<a name="l01354"></a>01354     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  MSP430_State(stop = TRUE)\n&quot;</span>);
<a name="l01355"></a>01355     RetState = MSP430_State(&amp;lState, TRUE, NULL);
<a name="l01356"></a>01356     <span class="keywordflow">if</span> (RetState != STATUS_OK)
<a name="l01357"></a>01357     {
<a name="l01358"></a>01358         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;  ERROR: MSP430_State()\n&quot;</span>);
<a name="l01359"></a>01359         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_STATE_STOP, 0);
<a name="l01360"></a>01360     }
<a name="l01361"></a>01361 }
<a name="l01362"></a>01362 
<a name="l01363"></a>01363 <span class="comment">/*****************************************************************************/</span>
<a name="l01367"></a><a class="code" href="_std_use_case_8h.html#a3f8c1538847f3496577ca0295eeb5918">01367</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a3f8c1538847f3496577ca0295eeb5918" title="Perform a single step in the target code.">StdUseCase_EemSingleStep</a>(DWORD dwMilliseconds)
<a name="l01368"></a>01368 {
<a name="l01369"></a>01369     STATUS_T RetState;
<a name="l01370"></a>01370 
<a name="l01371"></a>01371     RetState = STATUS_ERROR;
<a name="l01372"></a>01372 
<a name="l01373"></a>01373     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  MSP430_Run()\n&quot;</span>);
<a name="l01374"></a>01374     RetState = MSP430_Run(SINGLE_STEP, FALSE);
<a name="l01375"></a>01375     <span class="keywordflow">if</span> (RetState != STATUS_OK)
<a name="l01376"></a>01376     {
<a name="l01377"></a>01377         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_RUN, 0);
<a name="l01378"></a>01378     }
<a name="l01379"></a>01379     <span class="keywordflow">if</span>(!<a class="code" href="_std_use_case_8cpp.html#a4c4db3ac43346e02173b69bc9895f2fd" title="Wait for specific event.">StdUseCase_WaitForEvent</a>(WM_SsMESSAGE, dwMilliseconds))
<a name="l01380"></a>01380     {
<a name="l01381"></a>01381         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_RUN, 0);
<a name="l01382"></a>01382     }
<a name="l01383"></a>01383 }
<a name="l01384"></a>01384 
<a name="l01385"></a>01385 <span class="comment">/*****************************************************************************/</span>
<a name="l01396"></a><a class="code" href="_std_use_case_8h.html#a843299a7064855a1800da794ece45cc7">01396</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a843299a7064855a1800da794ece45cc7" title="Reset the device using the specified method(s)">StdUseCase_Reset</a>(LONG method, LONG execute, LONG releaseJTAG)
<a name="l01397"></a>01397 {
<a name="l01398"></a>01398     <a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd" title="Return value for MSP430_Reset.">Ret_Reset</a> = MSP430_Reset(method, execute, releaseJTAG);
<a name="l01399"></a>01399     <span class="keywordflow">if</span> (<a class="code" href="_std_use_case_8cpp.html#a94b8e76613f47c3fe8cd414219519cfd" title="Return value for MSP430_Reset.">Ret_Reset</a> != STATUS_OK)
<a name="l01400"></a>01400     {
<a name="l01401"></a>01401         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_RUN, 0);
<a name="l01402"></a>01402     }
<a name="l01403"></a>01403 }
<a name="l01404"></a>01404 
<a name="l01405"></a>01405 <span class="comment">/*****************************************************************************/</span>
<a name="l01407"></a><a class="code" href="_std_use_case_8h.html#a956d9ea54e17776013f1700271d2939b">01407</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a956d9ea54e17776013f1700271d2939b" title="This function reads all CPU registers and prints/logs their content.">StdUseCase_GetCpuState</a>(<span class="keywordtype">void</span>)
<a name="l01408"></a>01408 {
<a name="l01409"></a>01409     STATUS_T RetState;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411     RetState = STATUS_ERROR;
<a name="l01412"></a>01412 
<a name="l01413"></a>01413     RetState = MSP430_Registers(<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>, ALL_REGS, READ);
<a name="l01414"></a>01414     <span class="keywordflow">if</span> (RetState != STATUS_OK)
<a name="l01415"></a>01415     {
<a name="l01416"></a>01416         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;  ERROR: MSP430_Registers(..., ALL_REGS, READ)\n&quot;</span>);
<a name="l01417"></a>01417         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_REGISTER_READ, 0);
<a name="l01418"></a>01418     }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||  Processor State: CPU Registers\n&quot;</span>);
<a name="l01421"></a>01421     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||              PC=0x%5.5X R4 =0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[PC],<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R4]);
<a name="l01422"></a>01422     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||              SP=0x%5.5X R5 =0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[SP],<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R5]);
<a name="l01423"></a>01423     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||              SR=0x%5.5X R6 =0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[SR],<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R6]);
<a name="l01424"></a>01424     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R7 =0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R7]);
<a name="l01425"></a>01425     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R8 =0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R8]);
<a name="l01426"></a>01426     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R9 =0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R9]);
<a name="l01427"></a>01427     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R10=0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R10]);
<a name="l01428"></a>01428     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R11=0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R11]);
<a name="l01429"></a>01429     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R12=0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R12]);
<a name="l01430"></a>01430     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R13=0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R13]);
<a name="l01431"></a>01431     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R14=0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R14]);
<a name="l01432"></a>01432     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  ||                         R15=0x%5.5X\n&quot;</span>,<a class="code" href="_std_use_case_8cpp.html#a0bdeb3e3473b3f68074570ba8c658a62" title="Array for target device CPU register content.">g_lTargetDeviceRegisters</a>[R15]);
<a name="l01433"></a>01433 }
<a name="l01434"></a>01434 
<a name="l01435"></a>01435 <span class="comment">/*****************************************************************************/</span>
<a name="l01440"></a><a class="code" href="_std_use_case_8h.html#a30b43d0e7b1ade750d368db752c8dfd0">01440</a> BOOL <a class="code" href="_std_use_case_8cpp.html#a30b43d0e7b1ade750d368db752c8dfd0" title="Wait for trigger or timeout.">StdUseCase_WaitForTrigger</a>(DWORD dwMilliseconds)
<a name="l01441"></a>01441 {
<a name="l01442"></a>01442     BOOL RetState;
<a name="l01443"></a>01443 
<a name="l01444"></a>01444     RetState = FALSE;
<a name="l01445"></a>01445 
<a name="l01446"></a>01446     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Waiting for event (trigger or timeout %d sec)...\n&quot;</span>,dwMilliseconds/1000);
<a name="l01447"></a>01447     
<a name="l01448"></a>01448     <span class="comment">// wait until breakpoint hit occurs or wait for dwMilliseconds milliseconds</span>
<a name="l01449"></a>01449     <span class="comment">// if event occurs, BpMessage is locked up in MY_DLL430_CallbackFunc</span>
<a name="l01450"></a>01450     <span class="keywordflow">if</span> (MyEvent.wait(dwMilliseconds))
<a name="l01451"></a>01451     {
<a name="l01452"></a>01452         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  EVENT: EEM TRIGGER occured\n&quot;</span>);
<a name="l01453"></a>01453         MyEvent.reset();
<a name="l01454"></a>01454         RetState = TRUE;
<a name="l01455"></a>01455     }
<a name="l01456"></a>01456     <span class="keywordflow">else</span>
<a name="l01457"></a>01457     {
<a name="l01458"></a>01458         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;  EVENT: Timeout occured\n&quot;</span>);
<a name="l01459"></a>01459         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_VARIOUS, 0);
<a name="l01460"></a>01460     }
<a name="l01461"></a>01461 
<a name="l01462"></a>01462     <span class="keywordflow">return</span> RetState;
<a name="l01463"></a>01463 }
<a name="l01464"></a>01464 
<a name="l01465"></a>01465 <span class="comment">/*****************************************************************************/</span>
<a name="l01471"></a><a class="code" href="_std_use_case_8h.html#a4c4db3ac43346e02173b69bc9895f2fd">01471</a> BOOL <a class="code" href="_std_use_case_8cpp.html#a4c4db3ac43346e02173b69bc9895f2fd" title="Wait for specific event.">StdUseCase_WaitForEvent</a>(UINT MsgId, DWORD dwMilliseconds)
<a name="l01472"></a>01472 {
<a name="l01473"></a>01473     BOOL   RetState;
<a name="l01474"></a>01474     <a class="code" href="class_event.html">Event</a> *EventToWaitFor = NULL;
<a name="l01475"></a>01475 
<a name="l01476"></a>01476     RetState = FALSE;
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Waiting for -&gt; &quot;</span>);
<a name="l01479"></a>01479     <span class="keywordflow">switch</span>(MsgId)
<a name="l01480"></a>01480     {
<a name="l01481"></a>01481     <span class="keywordflow">case</span> WM_BpMESSAGE:
<a name="l01482"></a>01482         EventToWaitFor = &amp;MyBpEvent;
<a name="l01483"></a>01483         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Breakpoint hit &quot;</span>);
<a name="l01484"></a>01484         <span class="keywordflow">break</span>;
<a name="l01485"></a>01485     <span class="keywordflow">case</span> WM_SsMESSAGE:
<a name="l01486"></a>01486         EventToWaitFor = &amp;MySsEvent;
<a name="l01487"></a>01487         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Single step complete &quot;</span>);
<a name="l01488"></a>01488         <span class="keywordflow">break</span>;
<a name="l01489"></a>01489     <span class="keywordflow">case</span> WM_StoMESSAGE:
<a name="l01490"></a>01490         EventToWaitFor = &amp;MyStoEvent;
<a name="l01491"></a>01491         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Storage on trace buffer &quot;</span>);
<a name="l01492"></a>01492         <span class="keywordflow">break</span>;
<a name="l01493"></a>01493     <span class="keywordflow">case</span> WM_SStateMESSAGE:
<a name="l01494"></a>01494         EventToWaitFor = &amp;MySStateEvent;
<a name="l01495"></a>01495         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Change in new state of the sequencer &quot;</span>);
<a name="l01496"></a>01496         <span class="keywordflow">break</span>;
<a name="l01497"></a>01497     <span class="keywordflow">case</span> WM_CPUStopMESSAGE:
<a name="l01498"></a>01498         EventToWaitFor = &amp;MyCPUStopEvent;
<a name="l01499"></a>01499         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Device CPU stopped &quot;</span>);
<a name="l01500"></a>01500         <span class="keywordflow">break</span>;
<a name="l01501"></a>01501     <span class="keywordflow">default</span>:
<a name="l01502"></a>01502         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;   \n  %%ERROR%%: Not a defined event. Execution will continue immediately.\n&quot;</span>);
<a name="l01503"></a>01503         <span class="keywordflow">break</span>;
<a name="l01504"></a>01504     }
<a name="l01505"></a>01505 
<a name="l01506"></a>01506     <span class="keywordflow">if</span>(EventToWaitFor)
<a name="l01507"></a>01507     {
<a name="l01508"></a>01508         <span class="keywordflow">if</span>(dwMilliseconds == INFINITE)
<a name="l01509"></a>01509         {
<a name="l01510"></a>01510             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  (INFINITE)...\n&quot;</span>);
<a name="l01511"></a>01511         }
<a name="l01512"></a>01512         <span class="keywordflow">else</span>
<a name="l01513"></a>01513         {
<a name="l01514"></a>01514             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  (timeout %d sec)...\n&quot;</span>,dwMilliseconds/1000);
<a name="l01515"></a>01515         }
<a name="l01516"></a>01516         <span class="comment">// wait until breakpoint hit occurs or wait for dwMilliseconds milliseconds</span>
<a name="l01517"></a>01517         <span class="comment">// if event occurs, BpMessage is locked up in MY_DLL430_CallbackFunc</span>
<a name="l01518"></a>01518         <span class="keywordflow">if</span> (EventToWaitFor-&gt;wait(dwMilliseconds))
<a name="l01519"></a>01519         {
<a name="l01520"></a>01520             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  EVENT: occured\n&quot;</span>);
<a name="l01521"></a>01521             MyStoEvent.reset();
<a name="l01522"></a>01522             RetState = TRUE;
<a name="l01523"></a>01523         }
<a name="l01524"></a>01524         <span class="keywordflow">else</span>
<a name="l01525"></a>01525         {
<a name="l01526"></a>01526             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;  EVENT: Timeout occured\n&quot;</span>);
<a name="l01527"></a>01527         }
<a name="l01528"></a>01528     }
<a name="l01529"></a>01529     <span class="keywordflow">return</span> RetState;
<a name="l01530"></a>01530 }
<a name="l01531"></a>01531 
<a name="l01532"></a>01532 <span class="comment">/*****************************************************************************/</span>
<a name="l01536"></a><a class="code" href="_std_use_case_8h.html#a401ecd4364d7f8f6f6458ac3714f4306">01536</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a401ecd4364d7f8f6f6458ac3714f4306" title="Read the state storage buffer.">StdUseCase_EemReadStateStorageBuffer</a>(WORD NumberOfValidEntries)
<a name="l01537"></a>01537 {
<a name="l01538"></a>01538     STATUS_T RetState;
<a name="l01539"></a>01539     TraceBuffer_t TraceBuffer[8];       <span class="comment">// place for 8 state storage entries</span>
<a name="l01540"></a>01540 
<a name="l01541"></a>01541     RetState = STATUS_ERROR;
<a name="l01542"></a>01542 
<a name="l01543"></a>01543     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  MSP430_EEM_ReadTraceBuffer()\n&quot;</span>);
<a name="l01544"></a>01544     RetState = MSP430_EEM_ReadTraceBuffer(TraceBuffer);
<a name="l01545"></a>01545     <span class="keywordflow">if</span>(RetState != STATUS_OK)
<a name="l01546"></a>01546     {
<a name="l01547"></a>01547         <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(EXIT_EEM_READTRACEBUFFER, 0);
<a name="l01548"></a>01548     }
<a name="l01549"></a>01549 
<a name="l01550"></a>01550     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Nr.  MAB    MDB    Ctrl\n&quot;</span>);
<a name="l01551"></a>01551     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l01552"></a>01552     {
<a name="l01553"></a>01553         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  %i:   %04x   %04x   %04x   &quot;</span>, i+1, TraceBuffer[i].lTrBufMAB, TraceBuffer[i].lTrBufMDB, TraceBuffer[i].wTrBufCNTRL);
<a name="l01554"></a>01554         <span class="keywordflow">if</span>(i &lt; NumberOfValidEntries)
<a name="l01555"></a>01555         {
<a name="l01556"></a>01556             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  New\n&quot;</span>);
<a name="l01557"></a>01557         }
<a name="l01558"></a>01558         <span class="keywordflow">else</span>
<a name="l01559"></a>01559         {
<a name="l01560"></a>01560             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Old\n&quot;</span>);
<a name="l01561"></a>01561         }
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563 }
<a name="l01564"></a>01564 
<a name="l01565"></a>01565 <span class="comment">/*****************************************************************************/</span>
<a name="l01568"></a><a class="code" href="_std_use_case_8h.html#a7df8edfaa01d1b7881b05191d870fdde">01568</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a7df8edfaa01d1b7881b05191d870fdde" title="This function prints and logs all Breakpoint parameters.">StdUseCase_PrintBpParameter_t</a>(BpParameter_t* pBpBuffer)
<a name="l01569"></a>01569 {
<a name="l01570"></a>01570     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  Content of BpParameter_t struct:\n&quot;</span>);
<a name="l01571"></a>01571     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpMode:        0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpMode);
<a name="l01572"></a>01572     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  lAddrVal:      0x%5.5X\n&quot;</span>,pBpBuffer-&gt;lAddrVal);
<a name="l01573"></a>01573     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpType:        0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpType);
<a name="l01574"></a>01574     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  lReg:          0x%5.5X\n&quot;</span>,pBpBuffer-&gt;lReg);
<a name="l01575"></a>01575     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpAccess:      0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpAccess);
<a name="l01576"></a>01576     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpAction:      0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpAction);
<a name="l01577"></a>01577     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpOperat:      0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpOperat);
<a name="l01578"></a>01578     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  lMask:         0x%5.5X\n&quot;</span>,pBpBuffer-&gt;lMask);
<a name="l01579"></a>01579     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  lRangeEndAdVa: 0x%5.5X\n&quot;</span>,pBpBuffer-&gt;lRangeEndAdVa);
<a name="l01580"></a>01580     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpRangeAction: 0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpRangeAction);
<a name="l01581"></a>01581     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpCondition:   0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpCondition);
<a name="l01582"></a>01582     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  lCondMdbVal:   0x%5.5X\n&quot;</span>,pBpBuffer-&gt;lCondMdbVal);
<a name="l01583"></a>01583     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpCondAccess:  0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpCondAccess);
<a name="l01584"></a>01584     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  lCondMask:     0x%5.5X\n&quot;</span>,pBpBuffer-&gt;lCondMask);
<a name="l01585"></a>01585     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  bpCondOperat:  0x%5.5X\n&quot;</span>,pBpBuffer-&gt;bpCondOperat);
<a name="l01586"></a>01586     <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;  wExtCombine:   0x%5.5X\n&quot;</span>,pBpBuffer-&gt;wExtCombine);
<a name="l01587"></a>01587 }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589 <span class="comment">/*****************************************************************************/</span>
<a name="l01599"></a><a class="code" href="_std_use_case_8h.html#a9b07175fdfea91c212f7dc65107ef6bd">01599</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a9b07175fdfea91c212f7dc65107ef6bd" title="This function is of type MSP430_FET_NOTIFY_FUNC and generates system messages to inform the user of t...">MY_MSP430_CallbackFunc</a>( UINT MsgId, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> wParam, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lParam, LONG clientHandle)
<a name="l01600"></a>01600 {
<a name="l01601"></a>01601     <span class="keywordflow">if</span>(clientHandle == <a class="code" href="_std_use_case_8cpp.html#a699f2f70c2c4eb89b277c536dc217b76" title="Handle for FW update callback function.">myHandle</a>)
<a name="l01602"></a>01602     {
<a name="l01603"></a>01603         <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> out_length;    <span class="comment">// keeps track of the number of characters output for formatting purposes</span>
<a name="l01604"></a>01604         <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prog_bar_idx;  <span class="comment">// index for outputting progress bar symbols        </span>
<a name="l01605"></a>01605         
<a name="l01606"></a>01606         <span class="keywordflow">switch</span>(MsgId)
<a name="l01607"></a>01607         {
<a name="l01608"></a>01608             <span class="keywordflow">case</span> BL_INIT:
<a name="l01609"></a>01609                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;\n* *********************************************************\n&quot;</span>);
<a name="l01610"></a>01610                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *                                                        \n&quot;</span>);
<a name="l01611"></a>01611                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *  Initializing Update Bootloader.                       \n&quot;</span>);
<a name="l01612"></a>01612                 <span class="keywordflow">break</span>;
<a name="l01613"></a>01613             <span class="keywordflow">case</span> BL_ERASE_INT_VECTORS:
<a name="l01614"></a>01614                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *  Erasing mapped interrupt vectors.                     \n&quot;</span>);
<a name="l01615"></a>01615                 <span class="keywordflow">break</span>;
<a name="l01616"></a>01616             <span class="keywordflow">case</span> BL_ERASE_FIRMWARE:
<a name="l01617"></a>01617                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *  Erasing firmware memory section.                      \n&quot;</span>);
<a name="l01618"></a>01618                 <span class="keywordflow">break</span>;
<a name="l01619"></a>01619             <span class="keywordflow">case</span> BL_PROGRAM_FIRMWARE:
<a name="l01620"></a>01620                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *  Programming new firmware:                             \n&quot;</span>);
<a name="l01621"></a>01621                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01622"></a>01622                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> |= <a class="code" href="_std_use_case_8h.html#a8af06d1472cd4e892e5f53812685b9a0" title="This flag is set.">PROG_BAR_ON</a>;
<a name="l01623"></a>01623                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad86ef0ad08a24ecae8a2e95b350a7ca7" title="Log message.">LOG_MSG</a>, <span class="stringliteral">&quot;* *  PROGRESS BAR                                         \n&quot;</span>);
<a name="l01624"></a>01624                 <span class="keywordflow">break</span>;
<a name="l01625"></a>01625             <span class="keywordflow">case</span> BL_DATA_BLOCK_PROGRAMMED:
<a name="l01626"></a>01626                 out_length = prog_bar_idx = 0;
<a name="l01627"></a>01627             
<a name="l01628"></a>01628                 <span class="keywordflow">if</span>(wParam_prev &gt; wParam) printf(<span class="stringliteral">&quot;\n&quot;</span>); 
<a name="l01629"></a>01629                 printf(<span class="stringliteral">&quot;\r&quot;</span>);
<a name="l01630"></a>01630                 out_length += printf(<span class="stringliteral">&quot;* *  &quot;</span>);
<a name="l01631"></a>01631             
<a name="l01632"></a>01632                 <span class="keywordflow">for</span>(prog_bar_idx = 0; prog_bar_idx &lt; wParam; prog_bar_idx += 2)
<a name="l01633"></a>01633                     out_length += printf(<span class="stringliteral">&quot;|&quot;</span>);                            <span class="comment">//prints | character for every 2% completion</span>
<a name="l01634"></a>01634             
<a name="l01635"></a>01635                 out_length += printf(<span class="stringliteral">&quot; %lu%%&quot;</span>, wParam);                    <span class="comment">//prints percentage of completion</span>
<a name="l01636"></a>01636             
<a name="l01637"></a>01637                 <span class="keywordflow">for</span>( ;out_length &lt;= 57; out_length++) printf(<span class="stringliteral">&quot; &quot;</span>);        <span class="comment">//completes the line and border        </span>
<a name="l01638"></a>01638                 <span class="keywordflow">break</span>;
<a name="l01639"></a>01639             <span class="keywordflow">case</span> BL_EXIT:
<a name="l01640"></a>01640                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01641"></a>01641                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp;= ~(<a class="code" href="_std_use_case_8h.html#a8af06d1472cd4e892e5f53812685b9a0" title="This flag is set.">PROG_BAR_ON</a>);
<a name="l01642"></a>01642                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *  Exit Update Bootlader and reboot firmware.            \n&quot;</span>);
<a name="l01643"></a>01643                 <span class="keywordflow">break</span>;
<a name="l01644"></a>01644             <span class="keywordflow">case</span> BL_UPDATE_DONE:
<a name="l01645"></a>01645                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;\n* *  Update was successfully finished.                   \n&quot;</span>);
<a name="l01646"></a>01646                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *                                                        \n&quot;</span>);
<a name="l01647"></a>01647                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* *********************************************************\n&quot;</span>);
<a name="l01648"></a>01648                 <span class="keywordflow">break</span>;
<a name="l01649"></a>01649             <span class="keywordflow">case</span> BL_UPDATE_ERROR:
<a name="l01650"></a>01650                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp;= ~(<a class="code" href="_std_use_case_8h.html#a8af06d1472cd4e892e5f53812685b9a0" title="This flag is set.">PROG_BAR_ON</a>);
<a name="l01651"></a>01651                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* *  An error occured during firmware update.             \n&quot;</span>);
<a name="l01652"></a>01652                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* *                                                       \n&quot;</span>);
<a name="l01653"></a>01653                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ********************************************************\n&quot;</span>);
<a name="l01654"></a>01654                 <span class="keywordflow">break</span>;
<a name="l01655"></a>01655             <span class="keywordflow">case</span> BL_WAIT_FOR_TIMEOUT:
<a name="l01656"></a>01656                 <a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp;= ~(<a class="code" href="_std_use_case_8h.html#a8af06d1472cd4e892e5f53812685b9a0" title="This flag is set.">PROG_BAR_ON</a>);
<a name="l01657"></a>01657                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* *  An error occured during firmware update.             \n&quot;</span>);
<a name="l01658"></a>01658                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* *                                                       \n&quot;</span>);
<a name="l01659"></a>01659                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ********************************************************\n&quot;</span>);
<a name="l01660"></a>01660                 <span class="keywordflow">break</span>;
<a name="l01661"></a>01661         }
<a name="l01662"></a>01662     }
<a name="l01663"></a>01663 }
<a name="l01664"></a>01664 
<a name="l01665"></a>01665 <span class="comment">/*****************************************************************************/</span>
<a name="l01671"></a><a class="code" href="_std_use_case_8h.html#a3de96b4e9ced730e55bb023c754528ea">01671</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a3de96b4e9ced730e55bb023c754528ea" title="Exit the Flasher routine, close the logfile.">StdUseCase_Exit</a>(<span class="keywordtype">int</span> exitCode, LONG <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>)
<a name="l01672"></a>01672 {
<a name="l01673"></a>01673     <span class="comment">// The ErrorNumber is cleared after it was read once. If it has been read</span>
<a name="l01674"></a>01674     <span class="comment">// out before, make sure it&#39;s not overwritten.</span>
<a name="l01675"></a>01675     <span class="keywordflow">if</span> (lErrorNumber == 0)
<a name="l01676"></a>01676     {
<a name="l01677"></a>01677         lErrorNumber = MSP430_Error_Number();
<a name="l01678"></a>01678     }
<a name="l01679"></a>01679 
<a name="l01680"></a>01680     <span class="keywordflow">if</span> (lErrorNumber)
<a name="l01681"></a>01681     {
<a name="l01682"></a>01682         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;# Exit: %d\n&quot;</span>, exitCode);
<a name="l01683"></a>01683         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;# ERROR: %s\n&quot;</span>, MSP430_Error_String(lErrorNumber));
<a name="l01684"></a>01684     }
<a name="l01685"></a>01685     <span class="keywordflow">else</span>
<a name="l01686"></a>01686     {
<a name="l01687"></a>01687         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;# Exit: %d\n&quot;</span>, exitCode);
<a name="l01688"></a>01688         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;# %s\n&quot;</span>, MSP430_Error_String(lErrorNumber));
<a name="l01689"></a>01689     }
<a name="l01690"></a>01690     
<a name="l01691"></a>01691     <a class="code" href="_std_use_case_8cpp.html#a62cd59b5bab747a6574843a42e18e0d8" title="Trigger VCC on and/or apply hard reset via RST/NMI (if specified in sOpt) and disconnect from the dev...">StdUseCase_Close</a>(&amp;<a class="code" href="_std_use_case_8cpp.html#a260a28c69ae5c28651de2e0ea758d3e4" title="Struct for command line options.">g_sOpt</a>);
<a name="l01692"></a>01692 
<a name="l01693"></a>01693     <span class="comment">// close logfile</span>
<a name="l01694"></a>01694     <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#aa57653e6a16d747a67dddb6ff569d9a1" title="File pointer for logfile.">lfile</a> != NULL)
<a name="l01695"></a>01695     {
<a name="l01696"></a>01696         fclose(<a class="code" href="_std_use_case_8cpp.html#aa57653e6a16d747a67dddb6ff569d9a1" title="File pointer for logfile.">lfile</a>);
<a name="l01697"></a>01697     }
<a name="l01698"></a>01698 
<a name="l01699"></a>01699     exit(exitCode);
<a name="l01700"></a>01700 }
<a name="l01701"></a>01701 
<a name="l01702"></a>01702 <span class="comment">/*****************************************************************************/</span>
<a name="l01706"></a><a class="code" href="_std_use_case_8h.html#a62cd59b5bab747a6574843a42e18e0d8">01706</a> <span class="keywordtype">void</span> <a class="code" href="_std_use_case_8cpp.html#a62cd59b5bab747a6574843a42e18e0d8" title="Trigger VCC on and/or apply hard reset via RST/NMI (if specified in sOpt) and disconnect from the dev...">StdUseCase_Close</a>(<a class="code" href="structs_def_options.html" title="Struct for storing command line options.">sDefOptions_t</a>* sOpt)
<a name="l01707"></a>01707 {
<a name="l01708"></a>01708     STATUS_T Ret_Close;
<a name="l01709"></a>01709     LONG <a class="code" href="_std_use_case_8cpp.html#a29091ad2a80e2eb194c600f4539cc9a1" title="Return value for MSP430_Error_Number.">lErrorNumber</a>;
<a name="l01710"></a>01710 
<a name="l01711"></a>01711     Ret_Close = STATUS_ERROR;
<a name="l01712"></a>01712     
<a name="l01713"></a>01713     <span class="keywordflow">if</span>(!(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a0386a731bd85686923d861f99fa28310" title="This flag is set if the flasher routine is aborted due to an error.">ALT_EXIT</a>))
<a name="l01714"></a>01714     {
<a name="l01715"></a>01715         <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#ad37cf60fd952ab943b649c66e787cc5a" title="This flag is set if a &#39;hard&#39; reset (using the RST/NMI pin) should be executed on exit.">RESET_ON_EXIT</a>)
<a name="l01716"></a>01716         {
<a name="l01717"></a>01717             <span class="keywordflow">if</span>(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; <a class="code" href="_std_use_case_8h.html#a7256c4cc2fdc7414d6c454f3e22125c1" title="This flag is set if JTAG fuse should be blown.">BLOW_FUSE</a>)
<a name="l01718"></a>01718             {
<a name="l01719"></a>01719                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* Fuse blow specified. Exit spec [RESET] ignored.&quot;</span>);
<a name="l01720"></a>01720             }
<a name="l01721"></a>01721             <span class="keywordflow">else</span>
<a name="l01722"></a>01722             {
<a name="l01723"></a>01723                 <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Resetting device (RST/NMI)...&quot;</span>);
<a name="l01724"></a>01724                 <a class="code" href="_std_use_case_8cpp.html#a843299a7064855a1800da794ece45cc7" title="Reset the device using the specified method(s)">StdUseCase_Reset</a>(FORCE_RST_RESET, FALSE, FALSE);
<a name="l01725"></a>01725             }
<a name="l01726"></a>01726         }
<a name="l01727"></a>01727 
<a name="l01728"></a>01728         <span class="keywordflow">if</span>(sOpt-&gt;pcVCC != 0)
<a name="l01729"></a>01729         {
<a name="l01730"></a>01730             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Starting target code execution...&quot;</span>);
<a name="l01731"></a>01731 
<a name="l01732"></a>01732             <span class="keywordflow">if</span>(!(<a class="code" href="_std_use_case_8cpp.html#afca3366cb3e64e16425f106ae9b4a3f8" title="This bitmask contains global states and is accessed in various functions.">inst_state</a> &amp; RESET_ON_EXIT))  <span class="comment">// if &quot;hard&quot; reset is not required</span>
<a name="l01733"></a>01733             {
<a name="l01734"></a>01734                 MSP430_Reset(ALL_RESETS, TRUE, FALSE);  <span class="comment">// do a &quot;soft&quot; reset</span>
<a name="l01735"></a>01735             }
<a name="l01736"></a>01736             <span class="keywordflow">else</span>
<a name="l01737"></a>01737             {
<a name="l01738"></a>01738                 <a class="code" href="_std_use_case_8cpp.html#a3c7974343a33a0806e8fb53104550cc9" title="Start the program execution.">StdUseCase_Run</a>();
<a name="l01739"></a>01739             }
<a name="l01740"></a>01740 
<a name="l01741"></a>01741             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Disconnecting from device...&quot;</span>);
<a name="l01742"></a>01742             Ret_Close = MSP430_Close(FALSE);   <span class="comment">// disconnect from MSP430 without turning down Vcc </span>
<a name="l01743"></a>01743         }
<a name="l01744"></a>01744         <span class="keywordflow">else</span>
<a name="l01745"></a>01745         {
<a name="l01746"></a>01746             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Powering down...&quot;</span>);
<a name="l01747"></a>01747             MSP430_Reset(ALL_RESETS, TRUE, FALSE);
<a name="l01748"></a>01748             <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>,<span class="stringliteral">&quot;* Disconnecting from device...&quot;</span>);
<a name="l01749"></a>01749             Ret_Close = MSP430_Close(TRUE);   <span class="comment">// disconnect from MSP430 - turn down Vcc </span>
<a name="l01750"></a>01750         }
<a name="l01751"></a>01751     }
<a name="l01752"></a>01752 
<a name="l01753"></a>01753     lErrorNumber = MSP430_Error_Number();
<a name="l01754"></a>01754     
<a name="l01755"></a>01755     <span class="keywordflow">if</span>((Ret_Close == STATUS_OK) || (lErrorNumber == 0))
<a name="l01756"></a>01756     {
<a name="l01757"></a>01757         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#af074e402f5bb0bff129fae467c8b852d" title="Report message.">REPORT_MSG</a>, <span class="stringliteral">&quot;* &quot;</span>);
<a name="l01758"></a>01758 
<a name="l01759"></a>01759         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l01760"></a>01760         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* Driver      : closed (%s)\n&quot;</span>, MSP430_Error_String(lErrorNumber));
<a name="l01761"></a>01761         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l01762"></a>01762         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#ad4268015f55b574a84b91fd36addafe1" title="Standard message.">STD_MSG</a>,<span class="stringliteral">&quot;*/\n&quot;</span>);
<a name="l01763"></a>01763     }
<a name="l01764"></a>01764     <span class="keywordflow">else</span>
<a name="l01765"></a>01765     {
<a name="l01766"></a>01766         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l01767"></a>01767         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ERROR on close: %s\n&quot;</span>, MSP430_Error_String(lErrorNumber));
<a name="l01768"></a>01768         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;* ----------------------------------------------------------------------------\n&quot;</span>);
<a name="l01769"></a>01769         <a class="code" href="_std_use_case_8h.html#a46d8d3f398f950c6d4c29fccee1e7070" title="This function logs messages and prints them to the console.">Print_N_Log</a>(<a class="code" href="_std_use_case_8h.html#a7a18f09d3bb5a5f03a55546e38f8efd8" title="Error message.">ERR_MSG</a>,<span class="stringliteral">&quot;*/\n&quot;</span>);
<a name="l01770"></a>01770     }    
<a name="l01771"></a>01771 }
<a name="l01772"></a>01772 
<a name="l01773"></a>01773 <span class="comment">/*****************************************************************************/</span>
<a name="l01774"></a>01774 <span class="comment">/*                           END OF SOURCE FILE                              */</span>
<a name="l01775"></a>01775 <span class="comment">/*****************************************************************************/</span>
</pre></div></div><!-- contents -->
<hr size="1" /><small>
Copyright  2014, Texas Instruments Incorporated</small>
</body>
</html>
